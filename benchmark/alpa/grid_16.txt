Working on case: BenchmarkCase(batch_size=1024, model_config=GPTModelConfig(seq_len=1024, hidden_size=4096, num_layers=32, num_heads=32, vocab_size=51200), num_micro_batches=32, parallel_mode='search', parallel_args=SearchParallelArgs(prefer_reduce_scatter=True, use_remat=True, num_auto_layers=8, auto_stage_option={'submesh_physical_shape_space': 'small_power_of_two', 'submesh_logical_shape_space': 'all', 'stage_imbalance_tolerance': 1.0, 'use_hlo_cost_model': True, 'profiling_database_filename': 'prof_database.pkl'}))
 - Prepare input: 0.05 s
 - Create train state: 6.53 s
-------------------- Automatic stage clustering --------------------
submesh_choices: ((1, 1), (1, 2), (1, 4), (1, 8), (1, 16))
- Profiling for submesh 4 (1, 16):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
cost[0, 7, 0]=1.009, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=52.185GB, intermediate=0.000GB, init=4.796GB, as_config=((16, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 7, 5]=1.030, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=52.356GB, intermediate=0.000GB, init=4.796GB, as_config=((16, 1), {})
cost[0, 7, 4]=2.523, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=19.742GB, intermediate=0.000GB, init=4.804GB, as_config=((1, 16), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 7, 1]=1.115, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=29.379GB, intermediate=0.000GB, init=4.796GB, as_config=((8, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 7, 3]=1.725, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=11.745GB, intermediate=0.000GB, init=4.800GB, as_config=((2, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 7, 2]=1.314, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=13.923GB, intermediate=0.000GB, init=4.797GB, as_config=((4, 4), {'force_batch_dim_to_mesh_dim': 0})
Profiling for submesh 4 (1, 16) takes 106.53 seconds
Profiled costs are: [[[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [1.00900048 1.11462171 1.31390435 1.72514947 2.52257713 1.03027753]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]]
Profiled max_n_succ_stages are: [[[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1 4096 4096 4096   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]]
--------------------------------------------------
- Profiling for submesh 3 (1, 8):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
cost[0, 1, 3]=0.616, max_n_succ_stage=38, Mem: avail=28.031GB, peak=15.835GB, intermediate=0.250GB, init=2.359GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 3, 3]=1.331, max_n_succ_stage=8, Mem: avail=28.031GB, peak=19.920GB, intermediate=0.500GB, init=3.566GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 1, 1]=0.548, max_n_succ_stage=247, Mem: avail=28.031GB, peak=10.111GB, intermediate=0.062GB, init=2.359GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 1, 0]=0.494, max_n_succ_stage=399, Mem: avail=28.031GB, peak=13.163GB, intermediate=0.031GB, init=2.359GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 1, 4]=0.498, max_n_succ_stage=351, Mem: avail=28.031GB, peak=14.652GB, intermediate=0.031GB, init=2.359GB, as_config=((8, 1), {})
cost[0, 1, 2]=0.661, max_n_succ_stage=121, Mem: avail=28.031GB, peak=10.314GB, intermediate=0.125GB, init=2.360GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 3, 0]=0.764, max_n_succ_stage=44, Mem: avail=28.031GB, peak=21.630GB, intermediate=0.062GB, init=3.563GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 3, 1]=0.848, max_n_succ_stage=96, Mem: avail=28.031GB, peak=12.317GB, intermediate=0.125GB, init=3.564GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 3, 2]=1.026, max_n_succ_stage=50, Mem: avail=28.031GB, peak=11.659GB, intermediate=0.250GB, init=3.565GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 2, 0]=0.738, max_n_succ_stage=51, Mem: avail=28.031GB, peak=21.290GB, intermediate=0.062GB, init=3.484GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 4, 3]=1.746, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=23.828GB, intermediate=0.750GB, init=4.693GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 3, 4]=0.764, max_n_succ_stage=40, Mem: avail=28.031GB, peak=21.849GB, intermediate=0.062GB, init=3.563GB, as_config=((8, 1), {})
cost[0, 2, 4]=0.742, max_n_succ_stage=30, Mem: avail=28.031GB, peak=22.590GB, intermediate=0.062GB, init=3.484GB, as_config=((8, 1), {})
cost[0, 2, 3]=1.276, max_n_succ_stage=7, Mem: avail=28.031GB, peak=20.253GB, intermediate=0.500GB, init=3.487GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 2, 1]=0.819, max_n_succ_stage=97, Mem: avail=28.031GB, peak=12.174GB, intermediate=0.125GB, init=3.485GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 2, 2]=0.989, max_n_succ_stage=51, Mem: avail=28.031GB, peak=11.315GB, intermediate=0.250GB, init=3.485GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 5, 0]=1.247, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=35.383GB, intermediate=0.125GB, init=5.814GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 4, 0]=1.003, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=28.382GB, intermediate=0.094GB, init=4.689GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 4, 4]=1.003, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=27.319GB, intermediate=0.094GB, init=4.689GB, as_config=((8, 1), {})
cost[0, 3, 4]=1.019, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=29.592GB, intermediate=0.094GB, init=4.797GB, as_config=((8, 1), {})
cost[1, 4, 2]=1.347, max_n_succ_stage=26, Mem: avail=28.031GB, peak=13.035GB, intermediate=0.375GB, init=4.690GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 4, 1]=1.113, max_n_succ_stage=45, Mem: avail=28.031GB, peak=14.568GB, intermediate=0.188GB, init=4.689GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 3, 0]=1.015, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=29.167GB, intermediate=0.094GB, init=4.797GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 3, 3]=1.758, max_n_succ_stage=0, Mem: avail=28.031GB, peak=21.840GB, intermediate=0.750GB, init=4.801GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 3, 2]=1.359, max_n_succ_stage=26, Mem: avail=28.031GB, peak=12.799GB, intermediate=0.375GB, init=4.799GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 3, 0]=0.521, max_n_succ_stage=377, Mem: avail=28.031GB, peak=13.753GB, intermediate=0.031GB, init=2.438GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 3, 1]=1.125, max_n_succ_stage=43, Mem: avail=28.031GB, peak=14.815GB, intermediate=0.188GB, init=4.798GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 3, 2]=0.697, max_n_succ_stage=119, Mem: avail=28.031GB, peak=10.534GB, intermediate=0.125GB, init=2.439GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 3, 1]=0.578, max_n_succ_stage=245, Mem: avail=28.031GB, peak=10.191GB, intermediate=0.062GB, init=2.438GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 3, 3]=0.652, max_n_succ_stage=39, Mem: avail=28.031GB, peak=15.503GB, intermediate=0.250GB, init=2.438GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 5, 1]=1.384, max_n_succ_stage=19, Mem: avail=28.031GB, peak=17.101GB, intermediate=0.250GB, init=5.815GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 4, 0]=1.254, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=36.293GB, intermediate=0.125GB, init=5.922GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 3, 4]=0.521, max_n_succ_stage=377, Mem: avail=28.031GB, peak=13.753GB, intermediate=0.031GB, init=2.438GB, as_config=((8, 1), {})
cost[0, 4, 3]=2.173, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=27.824GB, intermediate=1.000GB, init=5.927GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 4, 4]=1.258, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=35.719GB, intermediate=0.125GB, init=5.922GB, as_config=((8, 1), {})
cost[0, 4, 1]=1.390, max_n_succ_stage=18, Mem: avail=28.031GB, peak=17.124GB, intermediate=0.250GB, init=5.923GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 5, 0]=1.498, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=43.295GB, intermediate=0.156GB, init=7.048GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 5, 4]=1.247, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=35.383GB, intermediate=0.125GB, init=5.814GB, as_config=((8, 1), {})
cost[2, 4, 0]=0.760, max_n_succ_stage=44, Mem: avail=28.031GB, peak=21.630GB, intermediate=0.062GB, init=3.563GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 4, 2]=1.679, max_n_succ_stage=14, Mem: avail=28.031GB, peak=14.175GB, intermediate=0.500GB, init=5.924GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 5, 4]=1.501, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=41.595GB, intermediate=0.156GB, init=7.048GB, as_config=((8, 1), {})
cost[2, 4, 4]=0.760, max_n_succ_stage=40, Mem: avail=28.031GB, peak=21.849GB, intermediate=0.062GB, init=3.563GB, as_config=((8, 1), {})
cost[2, 4, 3]=1.319, max_n_succ_stage=6, Mem: avail=28.031GB, peak=20.706GB, intermediate=0.500GB, init=3.566GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 4, 2]=1.018, max_n_succ_stage=49, Mem: avail=28.031GB, peak=11.785GB, intermediate=0.250GB, init=3.565GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 5, 3]=2.174, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=25.381GB, intermediate=1.000GB, init=5.819GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 5, 2]=2.008, max_n_succ_stage=8, Mem: avail=28.031GB, peak=15.317GB, intermediate=0.625GB, init=7.050GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 5, 2]=1.675, max_n_succ_stage=15, Mem: avail=28.031GB, peak=14.160GB, intermediate=0.500GB, init=5.816GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 4, 1]=0.843, max_n_succ_stage=96, Mem: avail=28.031GB, peak=12.255GB, intermediate=0.125GB, init=3.564GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 5, 0]=1.003, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=28.382GB, intermediate=0.094GB, init=4.689GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 6, 4]=1.491, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=42.385GB, intermediate=0.156GB, init=6.939GB, as_config=((8, 1), {})
cost[0, 5, 1]=1.661, max_n_succ_stage=3, Mem: avail=28.031GB, peak=19.453GB, intermediate=0.312GB, init=7.049GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 4, 0]=0.516, max_n_succ_stage=382, Mem: avail=28.031GB, peak=13.597GB, intermediate=0.031GB, init=2.438GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 6, 4]=1.745, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=47.878GB, intermediate=0.188GB, init=8.173GB, as_config=((8, 1), {})
cost[0, 5, 3]=2.601, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=28.373GB, intermediate=1.250GB, init=7.054GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 5, 3]=1.746, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=24.328GB, intermediate=0.750GB, init=4.693GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 6, 3]=3.028, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=31.541GB, intermediate=1.500GB, init=8.180GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 4, 3]=0.648, max_n_succ_stage=39, Mem: avail=28.031GB, peak=15.347GB, intermediate=0.250GB, init=2.438GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 6, 0]=1.491, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=42.385GB, intermediate=0.156GB, init=6.939GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 7, 0]=1.969, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=59.189GB, intermediate=0.219GB, init=9.591GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 4, 1]=0.572, max_n_succ_stage=240, Mem: avail=28.031GB, peak=10.472GB, intermediate=0.062GB, init=2.438GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 4, 2]=0.689, max_n_succ_stage=117, Mem: avail=28.031GB, peak=10.784GB, intermediate=0.125GB, init=2.439GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 5, 1]=1.113, max_n_succ_stage=45, Mem: avail=28.031GB, peak=14.568GB, intermediate=0.188GB, init=4.689GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 5, 2]=1.347, max_n_succ_stage=26, Mem: avail=28.031GB, peak=12.910GB, intermediate=0.375GB, init=4.690GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 7, 4]=1.981, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=58.683GB, intermediate=0.219GB, init=9.591GB, as_config=((8, 1), {})
cost[3, 4, 4]=0.516, max_n_succ_stage=382, Mem: avail=28.031GB, peak=13.597GB, intermediate=0.031GB, init=2.438GB, as_config=((8, 1), {})
cost[2, 5, 4]=1.003, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=28.382GB, intermediate=0.094GB, init=4.689GB, as_config=((8, 1), {})
cost[1, 6, 3]=2.602, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=24.537GB, intermediate=1.250GB, init=6.945GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 6, 0]=1.741, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=50.296GB, intermediate=0.188GB, init=8.173GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 6, 1]=1.932, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=22.297GB, intermediate=0.375GB, init=8.174GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 6, 1]=1.655, max_n_succ_stage=4, Mem: avail=28.031GB, peak=19.476GB, intermediate=0.312GB, init=6.940GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 6, 2]=2.004, max_n_succ_stage=8, Mem: avail=28.031GB, peak=15.442GB, intermediate=0.625GB, init=6.942GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 7, 0]=1.719, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=51.277GB, intermediate=0.188GB, init=8.358GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 6, 0]=1.247, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=35.383GB, intermediate=0.125GB, init=5.814GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 5, 1]=0.843, max_n_succ_stage=94, Mem: avail=28.031GB, peak=12.536GB, intermediate=0.125GB, init=3.564GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 7, 3]=3.386, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=24.641GB, intermediate=1.750GB, init=9.599GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 6, 4]=1.247, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=35.383GB, intermediate=0.125GB, init=5.814GB, as_config=((8, 1), {})
cost[2, 6, 3]=2.174, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=27.480GB, intermediate=1.000GB, init=5.819GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 5, 4]=0.760, max_n_succ_stage=46, Mem: avail=28.031GB, peak=21.505GB, intermediate=0.062GB, init=3.563GB, as_config=((8, 1), {})
cost[3, 5, 0]=0.760, max_n_succ_stage=46, Mem: avail=28.031GB, peak=21.505GB, intermediate=0.062GB, init=3.563GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 5, 2]=1.018, max_n_succ_stage=49, Mem: avail=28.031GB, peak=11.785GB, intermediate=0.250GB, init=3.565GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 5, 3]=1.319, max_n_succ_stage=6, Mem: avail=28.031GB, peak=20.706GB, intermediate=0.500GB, init=3.566GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 6, 2]=1.675, max_n_succ_stage=15, Mem: avail=28.031GB, peak=14.192GB, intermediate=0.500GB, init=5.816GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 6, 1]=1.384, max_n_succ_stage=19, Mem: avail=28.031GB, peak=17.067GB, intermediate=0.250GB, init=5.815GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 7, 2]=2.293, max_n_succ_stage=2, Mem: avail=28.031GB, peak=17.267GB, intermediate=0.750GB, init=8.361GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 6, 2]=2.337, max_n_succ_stage=3, Mem: avail=28.031GB, peak=16.552GB, intermediate=0.750GB, init=8.176GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 7, 0]=1.475, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=44.276GB, intermediate=0.156GB, init=7.232GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 7, 1]=2.179, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=25.768GB, intermediate=0.438GB, init=9.592GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 7, 2]=2.625, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=18.502GB, intermediate=0.875GB, init=9.595GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 6, 0]=0.726, max_n_succ_stage=68, Mem: avail=28.031GB, peak=20.287GB, intermediate=0.062GB, init=3.376GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 6, 0]=1.003, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=28.382GB, intermediate=0.094GB, init=4.689GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 6, 4]=0.726, max_n_succ_stage=68, Mem: avail=28.031GB, peak=20.287GB, intermediate=0.062GB, init=3.376GB, as_config=((8, 1), {})
cost[4, 6, 3]=1.270, max_n_succ_stage=12, Mem: avail=28.031GB, peak=17.827GB, intermediate=0.500GB, init=3.379GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 7, 4]=1.727, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=49.471GB, intermediate=0.188GB, init=8.358GB, as_config=((8, 1), {})
cost[3, 6, 4]=1.003, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=28.382GB, intermediate=0.094GB, init=4.689GB, as_config=((8, 1), {})
cost[1, 7, 3]=2.959, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=23.768GB, intermediate=1.500GB, init=8.365GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 7, 0]=0.715, max_n_succ_stage=33, Mem: avail=28.031GB, peak=22.178GB, intermediate=0.062GB, init=3.669GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 6, 1]=0.807, max_n_succ_stage=100, Mem: avail=28.031GB, peak=11.973GB, intermediate=0.125GB, init=3.376GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 6, 2]=1.347, max_n_succ_stage=26, Mem: avail=28.031GB, peak=12.941GB, intermediate=0.375GB, init=4.690GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 6, 2]=0.978, max_n_succ_stage=51, Mem: avail=28.031GB, peak=11.503GB, intermediate=0.250GB, init=3.377GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 7, 3]=1.213, max_n_succ_stage=9, Mem: avail=28.031GB, peak=19.012GB, intermediate=0.500GB, init=3.672GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 7, 4]=1.483, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=42.469GB, intermediate=0.156GB, init=7.232GB, as_config=((8, 1), {})
cost[3, 6, 3]=1.746, max_n_succ_stage=2, Mem: avail=28.031GB, peak=21.015GB, intermediate=0.750GB, init=4.693GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 7, 1]=0.789, max_n_succ_stage=92, Mem: avail=28.031GB, peak=12.723GB, intermediate=0.125GB, init=3.669GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 7, 3]=1.628, max_n_succ_stage=5, Mem: avail=28.031GB, peak=18.608GB, intermediate=0.750GB, init=4.798GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 7, 4]=0.723, max_n_succ_stage=62, Mem: avail=28.031GB, peak=20.371GB, intermediate=0.062GB, init=3.669GB, as_config=((8, 1), {})
cost[4, 7, 0]=0.954, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=27.569GB, intermediate=0.094GB, init=4.794GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 7, 1]=1.902, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=22.852GB, intermediate=0.375GB, init=8.359GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 6, 1]=1.113, max_n_succ_stage=44, Mem: avail=28.031GB, peak=14.786GB, intermediate=0.188GB, init=4.689GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 7, 2]=0.945, max_n_succ_stage=48, Mem: avail=28.031GB, peak=12.077GB, intermediate=0.250GB, init=3.670GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 7, 4]=0.962, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=27.372GB, intermediate=0.094GB, init=4.794GB, as_config=((8, 1), {})
cost[4, 7, 1]=1.054, max_n_succ_stage=44, Mem: avail=28.031GB, peak=14.630GB, intermediate=0.188GB, init=4.795GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 7, 3]=2.104, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=21.112GB, intermediate=1.000GB, init=6.112GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 7, 2]=1.266, max_n_succ_stage=25, Mem: avail=28.031GB, peak=13.328GB, intermediate=0.375GB, init=4.796GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 7, 4]=1.240, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=35.467GB, intermediate=0.125GB, init=6.107GB, as_config=((8, 1), {})
cost[2, 7, 1]=1.631, max_n_succ_stage=2, Mem: avail=28.031GB, peak=19.789GB, intermediate=0.312GB, init=7.233GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 7, 2]=1.635, max_n_succ_stage=13, Mem: avail=28.031GB, peak=14.766GB, intermediate=0.500GB, init=6.109GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 7, 0]=1.231, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=37.274GB, intermediate=0.125GB, init=6.107GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 7, 2]=1.964, max_n_succ_stage=6, Mem: avail=28.031GB, peak=16.017GB, intermediate=0.625GB, init=7.235GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 7, 3]=2.532, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=26.756GB, intermediate=1.250GB, init=7.238GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 7, 1]=1.360, max_n_succ_stage=16, Mem: avail=28.031GB, peak=17.600GB, intermediate=0.250GB, init=6.108GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
Profiling for submesh 3 (1, 8) takes 360.43 seconds
Profiled costs are: [[[       inf        inf        inf        inf        inf        inf]
  [0.49438388 0.54765156 0.66058979 0.61634468 0.49808324        inf]
  [0.73801401 0.8185647  0.98946062 1.27641416 0.74171337        inf]
  [1.01523408 1.12527218 1.3589213  1.75825597 1.01893343        inf]
  [1.25409994 1.39024968 1.67942426 2.17333527 1.2577993         inf]
  [1.49773009 1.66116282 2.00829471 2.60090293 1.50142945        inf]
  [1.74136022 1.93207594 2.33716515 3.02847059 1.74505958        inf]
  [1.96931219 2.17896139 2.62543338 3.3860718  1.98124099        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [0.76448485 0.84844272 1.02610001 1.3313631  0.76448484        inf]
  [1.00335071 1.11342021 1.34660297 1.74644241 1.00335071        inf]
  [1.24698086 1.38433335 1.67547342 2.17401007 1.24698086        inf]
  [1.49061099 1.65524648 2.00434385 2.60157773 1.49061099        inf]
  [1.71856296 1.90218047 2.29316617 2.95924788 1.7267924         inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [0.52085471 0.57752959 0.69722923 0.65216432 0.52085471        inf]
  [0.75972058 0.84250709 1.01773253 1.31887475 0.75972058        inf]
  [1.00335073 1.11342022 1.34660298 1.74644241 1.00335073        inf]
  [1.24698086 1.38433335 1.67547342 2.17401007 1.24698086        inf]
  [1.47493283 1.63126735 1.96429573 2.53168022 1.48316227        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [0.51609044 0.57159395 0.68886175 0.64765957 0.51609044        inf]
  [0.7597206  0.8425071  1.01773254 1.31887475 0.7597206         inf]
  [1.00335073 1.11342022 1.34660298 1.74644241 1.00335073        inf]
  [1.2313027  1.36035422 1.63542529 2.10411256 1.23953214        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [0.72613066 0.80676129 0.97769637 1.27014567 0.72613066        inf]
  [0.95408264 1.05364673 1.26596461 1.62774687 0.96231208        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [0.71521677 0.78866924 0.94546165 1.21266757 0.72344621        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]]
Profiled max_n_succ_stages are: [[[ -1  -1  -1  -1  -1  -1]
  [399 247 121  38 351  -1]
  [ 51  97  51   7  30  -1]
  [ -1  43  26   0  -1  -1]
  [ -1  18  14  -1  -1  -1]
  [ -1   3   8  -1  -1  -1]
  [ -1  -1   3  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]]

 [[ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ 44  96  50   8  40  -1]
  [ -1  45  26  -1  -1  -1]
  [ -1  19  15  -1  -1  -1]
  [ -1   4   8  -1  -1  -1]
  [ -1  -1   2  -1  -1  -1]]

 [[ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [377 245 119  39 377  -1]
  [ 44  96  49   6  40  -1]
  [ -1  45  26  -1  -1  -1]
  [ -1  19  15  -1  -1  -1]
  [ -1   2   6  -1  -1  -1]]

 [[ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [382 240 117  39 382  -1]
  [ 46  94  49   6  46  -1]
  [ -1  44  26   2  -1  -1]
  [ -1  16  13  -1  -1  -1]]

 [[ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ 68 100  51  12  68  -1]
  [ -1  44  25   5  -1  -1]]

 [[ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ 33  92  48   9  62  -1]]

 [[ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]]

 [[ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]]]
--------------------------------------------------
- Profiling for submesh 2 (1, 4):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
cost[3, 4, 0]=1.013, max_n_succ_stage=78, Mem: avail=28.031GB, peak=18.193GB, intermediate=0.062GB, init=4.876GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 0, 3]=0.496, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=14.300GB, intermediate=0.000GB, init=2.467GB, as_config=((4, 1), {})
cost[4, 5, 0]=0.946, max_n_succ_stage=106, Mem: avail=28.031GB, peak=16.818GB, intermediate=0.062GB, init=4.501GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 3, 3]=1.022, max_n_succ_stage=87, Mem: avail=28.031GB, peak=17.630GB, intermediate=0.062GB, init=4.876GB, as_config=((4, 1), {})
cost[3, 4, 1]=1.128, max_n_succ_stage=50, Mem: avail=28.031GB, peak=16.691GB, intermediate=0.125GB, init=4.877GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 3, 2]=0.667, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=17.815GB, intermediate=0.000GB, init=2.628GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 0, 1]=0.546, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=14.407GB, intermediate=0.000GB, init=2.468GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 0, 0]=0.492, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=12.594GB, intermediate=0.000GB, init=2.467GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 0, 2]=0.544, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=14.300GB, intermediate=0.000GB, init=2.467GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 3, 0]=0.544, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=13.379GB, intermediate=0.000GB, init=2.626GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 3, 3]=0.544, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=13.566GB, intermediate=0.000GB, init=2.626GB, as_config=((4, 1), {})
cost[3, 3, 1]=0.606, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=14.065GB, intermediate=0.000GB, init=2.626GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 4, 2]=1.128, max_n_succ_stage=8, Mem: avail=28.031GB, peak=20.756GB, intermediate=0.250GB, init=4.876GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 5, 1]=1.057, max_n_succ_stage=59, Mem: avail=28.031GB, peak=15.941GB, intermediate=0.125GB, init=4.502GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 3, 1]=1.140, max_n_succ_stage=53, Mem: avail=28.031GB, peak=16.315GB, intermediate=0.125GB, init=4.877GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 1, 3]=0.974, max_n_succ_stage=68, Mem: avail=28.031GB, peak=18.957GB, intermediate=0.062GB, init=4.718GB, as_config=((4, 1), {})
cost[0, 1, 2]=1.077, max_n_succ_stage=7, Mem: avail=28.031GB, peak=21.142GB, intermediate=0.250GB, init=4.718GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 4, 3]=1.013, max_n_succ_stage=78, Mem: avail=28.031GB, peak=18.193GB, intermediate=0.062GB, init=4.876GB, as_config=((4, 1), {})
cost[2, 3, 2]=1.138, max_n_succ_stage=9, Mem: avail=28.031GB, peak=20.505GB, intermediate=0.250GB, init=4.876GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 2, 1]=1.069, max_n_succ_stage=62, Mem: avail=28.031GB, peak=15.628GB, intermediate=0.125GB, init=4.502GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 5, 3]=0.946, max_n_succ_stage=106, Mem: avail=28.031GB, peak=16.818GB, intermediate=0.062GB, init=4.501GB, as_config=((4, 1), {})
cost[0, 1, 1]=1.081, max_n_succ_stage=56, Mem: avail=28.031GB, peak=16.126GB, intermediate=0.125GB, init=4.718GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 2, 0]=0.956, max_n_succ_stage=108, Mem: avail=28.031GB, peak=16.693GB, intermediate=0.062GB, init=4.501GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 2, 3]=0.956, max_n_succ_stage=108, Mem: avail=28.031GB, peak=16.693GB, intermediate=0.062GB, init=4.501GB, as_config=((4, 1), {})
cost[0, 1, 0]=0.970, max_n_succ_stage=96, Mem: avail=28.031GB, peak=17.220GB, intermediate=0.062GB, init=4.718GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 3, 0]=1.022, max_n_succ_stage=87, Mem: avail=28.031GB, peak=17.630GB, intermediate=0.062GB, init=4.876GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 5, 2]=1.055, max_n_succ_stage=10, Mem: avail=28.031GB, peak=20.537GB, intermediate=0.250GB, init=4.501GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 2, 2]=1.058, max_n_succ_stage=16, Mem: avail=28.031GB, peak=19.158GB, intermediate=0.250GB, init=4.501GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 5, 1]=1.662, max_n_succ_stage=7, Mem: avail=28.031GB, peak=18.817GB, intermediate=0.250GB, init=7.128GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 5, 0]=1.490, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=22.506GB, intermediate=0.125GB, init=7.127GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 6, 2]=1.064, max_n_succ_stage=14, Mem: avail=28.031GB, peak=19.630GB, intermediate=0.250GB, init=4.501GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 6, 3]=0.956, max_n_succ_stage=101, Mem: avail=28.031GB, peak=17.130GB, intermediate=0.062GB, init=4.501GB, as_config=((4, 1), {})
cost[3, 5, 2]=1.982, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=29.147GB, intermediate=0.500GB, init=7.129GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 6, 1]=1.591, max_n_succ_stage=10, Mem: avail=28.031GB, peak=18.316GB, intermediate=0.250GB, init=6.753GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 3, 0]=1.500, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=21.944GB, intermediate=0.125GB, init=7.127GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 2, 0]=1.448, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=21.721GB, intermediate=0.125GB, init=6.969GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 4, 2]=1.982, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=28.397GB, intermediate=0.500GB, init=7.129GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 6, 0]=0.956, max_n_succ_stage=101, Mem: avail=28.031GB, peak=17.130GB, intermediate=0.062GB, init=4.501GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 6, 2]=1.902, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=23.749GB, intermediate=0.500GB, init=6.754GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 5, 3]=1.490, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=22.506GB, intermediate=0.125GB, init=7.127GB, as_config=((4, 1), {})
cost[4, 6, 0]=1.424, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=21.319GB, intermediate=0.125GB, init=6.752GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 3, 3]=1.500, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=22.131GB, intermediate=0.125GB, init=7.127GB, as_config=((4, 1), {})
cost[2, 4, 3]=1.490, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=22.131GB, intermediate=0.125GB, init=7.127GB, as_config=((4, 1), {})
cost[5, 6, 1]=1.069, max_n_succ_stage=56, Mem: avail=28.031GB, peak=16.316GB, intermediate=0.125GB, init=4.502GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 3, 2]=1.998, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=28.829GB, intermediate=0.500GB, init=7.129GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 2, 3]=1.452, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=23.458GB, intermediate=0.125GB, init=6.969GB, as_config=((4, 1), {})
cost[0, 2, 1]=1.615, max_n_succ_stage=10, Mem: avail=28.031GB, peak=18.252GB, intermediate=0.250GB, init=6.969GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 2, 2]=1.920, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=27.876GB, intermediate=0.500GB, init=6.971GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 3, 1]=1.674, max_n_succ_stage=8, Mem: avail=28.031GB, peak=18.566GB, intermediate=0.250GB, init=7.128GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[6, 7, 0]=0.926, max_n_succ_stage=72, Mem: avail=28.031GB, peak=18.363GB, intermediate=0.062GB, init=5.087GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[6, 7, 3]=0.933, max_n_succ_stage=70, Mem: avail=28.031GB, peak=18.455GB, intermediate=0.062GB, init=5.087GB, as_config=((4, 1), {})
cost[2, 4, 0]=1.490, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=21.944GB, intermediate=0.125GB, init=7.127GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[6, 7, 1]=1.022, max_n_succ_stage=44, Mem: avail=28.031GB, peak=17.214GB, intermediate=0.125GB, init=5.088GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[6, 7, 2]=0.988, max_n_succ_stage=15, Mem: avail=28.031GB, peak=18.705GB, intermediate=0.250GB, init=5.087GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 7, 0]=1.404, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=22.679GB, intermediate=0.125GB, init=7.338GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 4, 1]=1.662, max_n_succ_stage=7, Mem: avail=28.031GB, peak=18.816GB, intermediate=0.250GB, init=7.128GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 6, 3]=1.424, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=21.319GB, intermediate=0.125GB, init=6.752GB, as_config=((4, 1), {})
cost[5, 7, 1]=1.556, max_n_succ_stage=3, Mem: avail=28.031GB, peak=19.527GB, intermediate=0.250GB, init=7.339GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 7, 2]=1.841, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=23.283GB, intermediate=0.500GB, init=7.340GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 7, 2]=2.464, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=26.411GB, intermediate=0.750GB, init=9.592GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 7, 0]=1.872, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=26.867GB, intermediate=0.188GB, init=9.588GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 7, 3]=1.879, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=27.331GB, intermediate=0.188GB, init=9.589GB, as_config=((4, 1), {})
cost[4, 7, 1]=2.079, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=21.903GB, intermediate=0.375GB, init=9.590GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 7, 3]=1.411, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=23.018GB, intermediate=0.125GB, init=7.338GB, as_config=((4, 1), {})
Profiling for submesh 2 (1, 4) takes 183.83 seconds
Profiled costs are: [[[0.49219334 0.54625321 0.544472   0.49614668        inf        inf]
  [0.96999362 1.08053334 1.07660607 0.97394697        inf        inf]
  [1.44779391 1.61481515 1.92040275 1.45174725        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [0.95560459 1.06865103 1.05849104 0.95560459        inf        inf]
  [1.49997438 1.67414118 1.9978425  1.49997437        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [1.02217409 1.13985937 1.13763338 1.02217409        inf        inf]
  [1.49049358 1.66227299 1.98156998 1.49049357        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [0.54437381 0.60557875 0.66657949 0.5443738         inf        inf]
  [1.01269328 1.12799118 1.12829931 1.01269328        inf        inf]
  [1.49049359 1.662273   1.98156998 1.49049359        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [0.9461238  1.05674206 1.05508484 0.9461238         inf        inf]
  [1.42392409 1.59102387 1.90204161 1.42392409        inf        inf]
  [1.87189515 2.07858198 2.46444506 1.87940071        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [0.9556046  1.06861025 1.06441891 0.9556046         inf        inf]
  [1.40357566 1.55616836 1.8411393  1.41108123        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [0.92577537 1.02187822 0.98761472 0.93328093        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]]
Profiled max_n_succ_stages are: [[[4096 4096 4096 4096   -1   -1]
  [  96   56    7   68   -1   -1]
  [  -1   10   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [ 108   62   16  108   -1   -1]
  [  -1    8   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  87   53    9   87   -1   -1]
  [  -1    7   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [4096 4096 4096 4096   -1   -1]
  [  78   50    8   78   -1   -1]
  [  -1    7   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [ 106   59   10  106   -1   -1]
  [  -1   10   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [ 101   56   14  101   -1   -1]
  [  -1    3   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  72   44   15   70   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]]
--------------------------------------------------
- Profiling for submesh 1 (1, 2):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
cost[7, 7, 1]=0.969, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=28.339GB, intermediate=0.000GB, init=5.674GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[7, 7, 0]=0.893, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=24.301GB, intermediate=0.000GB, init=5.673GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[7, 7, 2]=0.899, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=23.840GB, intermediate=0.000GB, init=5.673GB, as_config=((2, 1), {})
cost[5, 5, 2]=0.953, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=21.003GB, intermediate=0.000GB, init=4.501GB, as_config=((2, 1), {})
cost[6, 6, 0]=0.953, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=20.878GB, intermediate=0.000GB, init=4.501GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[6, 7, 0]=1.846, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=27.926GB, intermediate=0.125GB, init=10.175GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 4, 1]=1.010, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=25.003GB, intermediate=0.000GB, init=4.502GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 5, 1]=1.033, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=26.253GB, intermediate=0.000GB, init=4.502GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 0, 0]=0.981, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=21.249GB, intermediate=0.000GB, init=4.935GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 1, 0]=0.953, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=20.128GB, intermediate=0.000GB, init=4.501GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 4, 0]=0.934, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=20.378GB, intermediate=0.000GB, init=4.501GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[6, 7, 2]=1.852, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=27.903GB, intermediate=0.125GB, init=10.175GB, as_config=((2, 1), {})
cost[0, 0, 2]=0.990, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=22.220GB, intermediate=0.000GB, init=4.935GB, as_config=((2, 1), {})
cost[1, 1, 2]=0.953, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=20.128GB, intermediate=0.000GB, init=4.501GB, as_config=((2, 1), {})
cost[0, 0, 1]=1.024, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=22.220GB, intermediate=0.000GB, init=4.935GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[6, 6, 2]=0.953, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=20.878GB, intermediate=0.000GB, init=4.501GB, as_config=((2, 1), {})
cost[2, 2, 2]=0.953, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=20.128GB, intermediate=0.000GB, init=4.501GB, as_config=((2, 1), {})
cost[1, 1, 1]=1.033, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=24.753GB, intermediate=0.000GB, init=4.502GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 2, 1]=1.033, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=24.753GB, intermediate=0.000GB, init=4.502GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 3, 0]=1.086, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=22.003GB, intermediate=0.000GB, init=5.251GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 3, 2]=1.086, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=22.128GB, intermediate=0.000GB, init=5.251GB, as_config=((2, 1), {})
cost[4, 4, 2]=0.934, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=20.503GB, intermediate=0.000GB, init=4.501GB, as_config=((2, 1), {})
cost[6, 6, 1]=1.033, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=25.503GB, intermediate=0.000GB, init=4.502GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 5, 0]=0.953, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=21.003GB, intermediate=0.000GB, init=4.501GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 3, 1]=1.172, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=27.128GB, intermediate=0.000GB, init=5.253GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 2, 0]=0.953, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=20.128GB, intermediate=0.000GB, init=4.501GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[6, 7, 1]=1.888, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=28.153GB, intermediate=0.250GB, init=10.175GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 2, 0]=1.906, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=24.879GB, intermediate=0.125GB, init=9.002GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 2, 2]=1.906, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=24.879GB, intermediate=0.125GB, init=9.002GB, as_config=((2, 1), {})
cost[4, 5, 0]=1.887, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=25.129GB, intermediate=0.125GB, init=9.002GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 6, 2]=1.906, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=25.754GB, intermediate=0.125GB, init=9.002GB, as_config=((2, 1), {})
cost[5, 6, 1]=1.979, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=30.379GB, intermediate=0.250GB, init=9.002GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 2, 1]=1.975, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=29.490GB, intermediate=0.250GB, init=9.002GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 6, 0]=1.906, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=25.754GB, intermediate=0.125GB, init=9.002GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 5, 1]=1.960, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=30.703GB, intermediate=0.250GB, init=9.002GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 5, 2]=1.887, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=25.129GB, intermediate=0.125GB, init=9.002GB, as_config=((2, 1), {})
Profiling for submesh 1 (1, 2) takes 68.61 seconds
Profiled costs are: [[[0.98135937 1.023738   0.99032148        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [0.95306539 1.03300978 0.95306539        inf        inf        inf]
  [1.90612652 1.97523774 1.90612652        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [0.95306539 1.03300978 0.95306539        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [1.08605852 1.17171602 1.08605851        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [0.93408582 1.00950835 0.93408582        inf        inf        inf]
  [1.88714696 1.95970203 1.88714696        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [0.9530654  1.03300978 0.9530654         inf        inf        inf]
  [1.90612653 1.97857896 1.90612653        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [0.95306539 1.03300978 0.95306539        inf        inf        inf]
  [1.84633139 1.88812867 1.85195378        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [0.89327026 0.96918854 0.89889265        inf        inf        inf]]]
Profiled max_n_succ_stages are: [[[4096 4096 4096   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [4096   -1 4096   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [4096   -1 4096   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [4096   -1 4096   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [4096   -1 4096   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [4096   -1 4096   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [4096   -1 4096   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]]
--------------------------------------------------
- Profiling for submesh 0 (1, 1):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
cost[7, 7, 0]=1.780, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=44.675GB, intermediate=0.000GB, init=11.347GB, as_config=((1, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[7, 7, 1]=1.780, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=44.675GB, intermediate=0.000GB, init=11.347GB, as_config=((1, 1), {})
cost[6, 6, 0]=1.899, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=39.253GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[6, 6, 1]=1.899, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=39.253GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {})
cost[2, 2, 1]=1.899, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=37.753GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {})
cost[4, 4, 0]=1.861, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=38.003GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 1, 1]=1.899, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=37.753GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {})
cost[4, 4, 1]=1.861, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=38.003GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {})
cost[5, 5, 0]=1.899, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=39.503GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 1, 0]=1.899, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=37.753GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 2, 0]=1.899, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=37.753GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 5, 1]=1.899, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=39.503GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {})
Profiling for submesh 0 (1, 1) takes 25.39 seconds
Profiled costs are: [[[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [1.89885045 1.89885045        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [1.89885045 1.89885045        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [1.86087335 1.86087335        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [1.89885045 1.89885045        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [1.89885045 1.89885045        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [1.78028767 1.78028767        inf        inf        inf        inf]]]
Profiled max_n_succ_stages are: [[[-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]]

 [[-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]]

 [[-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]]

 [[-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]]

 [[-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]]

 [[-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]]

 [[-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]]

 [[-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]]]
--------------------------------------------------
Compute cost saved to: compute-cost-2022-11-12-03-06-28.npy
----------------------------------------------------------------------
Result forward_stage_layer_ids: [[0, 1], [2, 3], [4, 5], [6, 7]]
Result mesh_shapes: [(1, 4), (1, 4), (1, 4), (1, 4)]
Result logical_mesh_shapes: [(4, 1), (4, 1), (4, 1), (4, 1)]
Result autosharding_option_dicts: [{'force_batch_dim_to_mesh_dim': 0}, {}, {'force_batch_dim_to_mesh_dim': 0}, {'force_batch_dim_to_mesh_dim': 0}]
 - Compile (driver): 832.03 s
compilation time breakdown: {'stage-construction': '750.18', 'stage-construction-dp': '1.68', 'stage-construction-compilation': '519.90', 'stage-construction-profiling': '224.85'}
 - Compile (worker): 51.92 s
Iteration 0 ...
Iteration 1 ...
Iteration 2 ...
 - Benchmark: 177.66 s
Type: gpt  Model Config: GPTModelConfig(seq_len=1024, hidden_size=4096, num_layers=32, num_heads=32, vocab_size=51200)  #Microbatch: 32  #GPU: 16  Parallel Config: SearchParallelArgs(prefer_reduce_scatter=True, use_remat=True, num_auto_layers=8, auto_stage_option={'submesh_physical_shape_space': 'small_power_of_two', 'submesh_logical_shape_space': 'all', 'stage_imbalance_tolerance': 1.0, 'use_hlo_cost_model': True, 'profiling_database_filename': 'prof_database.pkl'})  Mean Time (s): 48.727  Std Time (s): 0.043  #Params (Billion): 6.654B  TFLOPs: 73.90  Peak Mem (GB): 21.629  Metadata: {'compilation_times': "{'stage-construction': '750.18', 'stage-construction-dp': '1.68', 'stage-construction-compilation': '519.90', 'stage-construction-profiling': '224.85'}", 'compute_cost_file_name': 'compute-cost-2022-11-12-03-06-28.npy', 'forward_stage_layer_ids': '[[0, 1], [2, 3], [4, 5], [6, 7]]', 'submesh_shapes': '[[1, 4], [1, 4], [1, 4], [1, 4]]', 'logical_mesh_shapes': '[[4, 1], [4, 1], [4, 1], [4, 1]]', 'autosharding_option_dicts': "[{'force_batch_dim_to_mesh_dim': '0'}, {}, {'force_batch_dim_to_mesh_dim': '0'}, {'force_batch_dim_to_mesh_dim': '0'}]"}  
Working on case: BenchmarkCase(batch_size=1024, model_config=GPTModelConfig(seq_len=1024, hidden_size=4096, num_layers=32, num_heads=32, vocab_size=51200), num_micro_batches=64, parallel_mode='search', parallel_args=SearchParallelArgs(prefer_reduce_scatter=True, use_remat=True, num_auto_layers=8, auto_stage_option={'submesh_physical_shape_space': 'small_power_of_two', 'submesh_logical_shape_space': 'all', 'stage_imbalance_tolerance': 1.0, 'use_hlo_cost_model': True, 'profiling_database_filename': 'prof_database.pkl'}))
 - Prepare input: 0.05 s
 - Create train state: 6.54 s
-------------------- Automatic stage clustering --------------------
submesh_choices: ((1, 1), (1, 2), (1, 4), (1, 8), (1, 16))
- Profiling for submesh 4 (1, 16):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
cost[0, 7, 0]=0.536, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=52.060GB, intermediate=0.000GB, init=4.796GB, as_config=((16, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 7, 5]=0.554, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=50.754GB, intermediate=0.000GB, init=4.796GB, as_config=((16, 1), {})
cost[0, 7, 1]=0.592, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=26.439GB, intermediate=0.000GB, init=4.796GB, as_config=((8, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 7, 4]=1.356, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=11.090GB, intermediate=0.000GB, init=4.804GB, as_config=((1, 16), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 7, 2]=0.697, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=14.755GB, intermediate=0.000GB, init=4.797GB, as_config=((4, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 7, 3]=0.910, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=8.210GB, intermediate=0.000GB, init=4.800GB, as_config=((2, 8), {'force_batch_dim_to_mesh_dim': 0})
Profiling for submesh 4 (1, 16) takes 106.98 seconds
Profiled costs are: [[[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [0.53643001 0.59161008 0.69691899 0.90967581 1.35626837 0.55401453]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]]
Profiled max_n_succ_stages are: [[[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1 4096 4096 4096   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]]
--------------------------------------------------
- Profiling for submesh 3 (1, 8):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
cost[1, 3, 1]=0.432, max_n_succ_stage=232, Mem: avail=28.031GB, peak=9.863GB, intermediate=0.062GB, init=3.564GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 1, 4]=0.255, max_n_succ_stage=824, Mem: avail=28.031GB, peak=12.776GB, intermediate=0.016GB, init=2.359GB, as_config=((8, 1), {})
cost[0, 1, 0]=0.252, max_n_succ_stage=770, Mem: avail=28.031GB, peak=13.612GB, intermediate=0.016GB, init=2.359GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 1, 1]=0.279, max_n_succ_stage=588, Mem: avail=28.031GB, peak=7.239GB, intermediate=0.031GB, init=2.359GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 3, 3]=0.675, max_n_succ_stage=53, Mem: avail=28.031GB, peak=10.853GB, intermediate=0.250GB, init=3.566GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 1, 2]=0.335, max_n_succ_stage=310, Mem: avail=28.031GB, peak=6.228GB, intermediate=0.062GB, init=2.360GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 3, 2]=0.520, max_n_succ_stage=133, Mem: avail=28.031GB, peak=7.612GB, intermediate=0.125GB, init=3.565GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 1, 3]=0.315, max_n_succ_stage=70, Mem: avail=28.031GB, peak=12.095GB, intermediate=0.125GB, init=6.953GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 4, 3]=0.886, max_n_succ_stage=26, Mem: avail=28.031GB, peak=13.095GB, intermediate=0.375GB, init=4.693GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 2, 4]=0.379, max_n_succ_stage=183, Mem: avail=28.031GB, peak=18.778GB, intermediate=0.031GB, init=3.484GB, as_config=((8, 1), {})
cost[1, 4, 4]=0.511, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=25.178GB, intermediate=0.047GB, init=4.689GB, as_config=((8, 1), {})
cost[0, 2, 0]=0.376, max_n_succ_stage=156, Mem: avail=28.031GB, peak=19.614GB, intermediate=0.031GB, init=3.484GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 4, 1]=0.567, max_n_succ_stage=110, Mem: avail=28.031GB, peak=12.864GB, intermediate=0.094GB, init=4.689GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 2, 1]=0.417, max_n_succ_stage=237, Mem: avail=28.031GB, peak=9.646GB, intermediate=0.062GB, init=3.485GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 3, 1]=0.573, max_n_succ_stage=106, Mem: avail=28.031GB, peak=13.147GB, intermediate=0.094GB, init=4.798GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 2, 3]=0.648, max_n_succ_stage=53, Mem: avail=28.031GB, peak=11.002GB, intermediate=0.250GB, init=3.487GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 3, 4]=0.389, max_n_succ_stage=168, Mem: avail=28.031GB, peak=19.177GB, intermediate=0.031GB, init=3.563GB, as_config=((8, 1), {})
cost[1, 3, 0]=0.389, max_n_succ_stage=139, Mem: avail=28.031GB, peak=20.067GB, intermediate=0.031GB, init=3.563GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 2, 2]=0.502, max_n_succ_stage=137, Mem: avail=28.031GB, peak=7.291GB, intermediate=0.125GB, init=3.485GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 4, 2]=0.683, max_n_succ_stage=76, Mem: avail=28.031GB, peak=8.863GB, intermediate=0.188GB, init=4.690GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 3, 2]=0.689, max_n_succ_stage=76, Mem: avail=28.031GB, peak=8.783GB, intermediate=0.188GB, init=4.799GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 3, 0]=0.517, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=26.616GB, intermediate=0.047GB, init=4.797GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 3, 4]=0.520, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=25.889GB, intermediate=0.047GB, init=4.797GB, as_config=((8, 1), {})
cost[1, 4, 0]=0.511, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=26.069GB, intermediate=0.047GB, init=4.689GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 3, 3]=0.892, max_n_succ_stage=28, Mem: avail=28.031GB, peak=12.128GB, intermediate=0.375GB, init=4.801GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 5, 0]=0.635, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=32.071GB, intermediate=0.062GB, init=5.814GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 3, 1]=0.294, max_n_succ_stage=583, Mem: avail=28.031GB, peak=7.331GB, intermediate=0.031GB, init=2.438GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 3, 0]=0.265, max_n_succ_stage=793, Mem: avail=28.031GB, peak=13.175GB, intermediate=0.016GB, init=2.438GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 3, 2]=0.354, max_n_succ_stage=304, Mem: avail=28.031GB, peak=6.486GB, intermediate=0.062GB, init=2.439GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 4, 4]=0.642, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=31.890GB, intermediate=0.062GB, init=5.922GB, as_config=((8, 1), {})
cost[2, 3, 3]=0.333, max_n_succ_stage=46, Mem: avail=28.031GB, peak=14.456GB, intermediate=0.125GB, init=7.688GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 3, 4]=0.265, max_n_succ_stage=793, Mem: avail=28.031GB, peak=13.175GB, intermediate=0.016GB, init=2.438GB, as_config=((8, 1), {})
cost[0, 4, 3]=1.103, max_n_succ_stage=12, Mem: avail=28.031GB, peak=15.398GB, intermediate=0.500GB, init=5.927GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 4, 0]=0.638, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=32.617GB, intermediate=0.062GB, init=5.922GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 4, 1]=0.708, max_n_succ_stage=46, Mem: avail=28.031GB, peak=16.149GB, intermediate=0.125GB, init=5.923GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 5, 1]=0.705, max_n_succ_stage=49, Mem: avail=28.031GB, peak=15.865GB, intermediate=0.125GB, init=5.815GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 4, 0]=0.387, max_n_succ_stage=139, Mem: avail=28.031GB, peak=20.067GB, intermediate=0.031GB, init=3.563GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 4, 2]=0.851, max_n_succ_stage=47, Mem: avail=28.031GB, peak=10.034GB, intermediate=0.250GB, init=5.924GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 4, 1]=0.429, max_n_succ_stage=232, Mem: avail=28.031GB, peak=9.863GB, intermediate=0.062GB, init=3.564GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 4, 2]=0.516, max_n_succ_stage=133, Mem: avail=28.031GB, peak=7.675GB, intermediate=0.125GB, init=3.565GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 5, 3]=1.103, max_n_succ_stage=15, Mem: avail=28.031GB, peak=14.151GB, intermediate=0.500GB, init=5.819GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 4, 4]=0.387, max_n_succ_stage=168, Mem: avail=28.031GB, peak=19.177GB, intermediate=0.031GB, init=3.563GB, as_config=((8, 1), {})
cost[2, 4, 3]=0.669, max_n_succ_stage=51, Mem: avail=28.031GB, peak=11.247GB, intermediate=0.250GB, init=3.566GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 5, 0]=0.762, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=38.619GB, intermediate=0.078GB, init=7.048GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 5, 4]=0.635, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=32.071GB, intermediate=0.062GB, init=5.814GB, as_config=((8, 1), {})
cost[0, 5, 3]=1.320, max_n_succ_stage=7, Mem: avail=28.031GB, peak=15.956GB, intermediate=0.625GB, init=7.054GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 5, 4]=0.766, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=37.783GB, intermediate=0.078GB, init=7.048GB, as_config=((8, 1), {})
cost[1, 5, 2]=0.849, max_n_succ_stage=47, Mem: avail=28.031GB, peak=9.988GB, intermediate=0.250GB, init=5.816GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 5, 0]=0.511, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=26.069GB, intermediate=0.047GB, init=4.689GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 4, 1]=0.291, max_n_succ_stage=579, Mem: avail=28.031GB, peak=7.456GB, intermediate=0.031GB, init=2.438GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 5, 2]=1.018, max_n_succ_stage=30, Mem: avail=28.031GB, peak=11.168GB, intermediate=0.312GB, init=7.050GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 4, 0]=0.263, max_n_succ_stage=793, Mem: avail=28.031GB, peak=13.175GB, intermediate=0.016GB, init=2.438GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 6, 0]=0.759, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=38.072GB, intermediate=0.078GB, init=6.939GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 4, 2]=0.349, max_n_succ_stage=303, Mem: avail=28.031GB, peak=6.565GB, intermediate=0.062GB, init=2.439GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 5, 1]=0.846, max_n_succ_stage=10, Mem: avail=28.031GB, peak=19.150GB, intermediate=0.156GB, init=7.049GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 6, 4]=0.890, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=43.784GB, intermediate=0.094GB, init=8.173GB, as_config=((8, 1), {})
cost[1, 6, 4]=0.759, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=38.072GB, intermediate=0.078GB, init=6.939GB, as_config=((8, 1), {})
cost[3, 4, 3]=0.331, max_n_succ_stage=45, Mem: avail=28.031GB, peak=14.550GB, intermediate=0.125GB, init=7.688GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 4, 4]=0.263, max_n_succ_stage=793, Mem: avail=28.031GB, peak=13.175GB, intermediate=0.016GB, init=2.438GB, as_config=((8, 1), {})
cost[2, 5, 2]=0.683, max_n_succ_stage=76, Mem: avail=28.031GB, peak=8.753GB, intermediate=0.188GB, init=4.690GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 5, 4]=0.511, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=26.069GB, intermediate=0.047GB, init=4.689GB, as_config=((8, 1), {})
cost[2, 5, 1]=0.567, max_n_succ_stage=110, Mem: avail=28.031GB, peak=12.864GB, intermediate=0.094GB, init=4.689GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 5, 3]=0.886, max_n_succ_stage=25, Mem: avail=28.031GB, peak=13.345GB, intermediate=0.375GB, init=4.693GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 6, 1]=0.844, max_n_succ_stage=13, Mem: avail=28.031GB, peak=18.867GB, intermediate=0.156GB, init=6.940GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 6, 0]=0.886, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=44.621GB, intermediate=0.094GB, init=8.173GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 6, 3]=1.320, max_n_succ_stage=10, Mem: avail=28.031GB, peak=14.023GB, intermediate=0.625GB, init=6.945GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 6, 4]=0.635, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=32.071GB, intermediate=0.062GB, init=5.814GB, as_config=((8, 1), {})
cost[3, 5, 0]=0.387, max_n_succ_stage=139, Mem: avail=28.031GB, peak=20.068GB, intermediate=0.031GB, init=3.563GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 7, 4]=1.010, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=51.057GB, intermediate=0.109GB, init=9.591GB, as_config=((8, 1), {})
cost[1, 6, 2]=1.016, max_n_succ_stage=30, Mem: avail=28.031GB, peak=11.239GB, intermediate=0.312GB, init=6.942GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 6, 1]=0.705, max_n_succ_stage=49, Mem: avail=28.031GB, peak=15.865GB, intermediate=0.125GB, init=5.815GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 5, 1]=0.429, max_n_succ_stage=231, Mem: avail=28.031GB, peak=9.926GB, intermediate=0.062GB, init=3.564GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 7, 0]=0.874, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=45.637GB, intermediate=0.094GB, init=8.358GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 6, 1]=0.985, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=22.151GB, intermediate=0.188GB, init=8.174GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 7, 0]=1.002, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=52.185GB, intermediate=0.109GB, init=9.591GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 6, 0]=0.635, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=32.071GB, intermediate=0.062GB, init=5.814GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 6, 3]=1.537, max_n_succ_stage=1, Mem: avail=28.031GB, peak=17.824GB, intermediate=0.750GB, init=8.180GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 6, 2]=1.184, max_n_succ_stage=18, Mem: avail=28.031GB, peak=12.364GB, intermediate=0.375GB, init=8.176GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 5, 4]=0.387, max_n_succ_stage=139, Mem: avail=28.031GB, peak=20.068GB, intermediate=0.031GB, init=3.563GB, as_config=((8, 1), {})
cost[1, 7, 4]=0.879, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=44.377GB, intermediate=0.094GB, init=8.358GB, as_config=((8, 1), {})
cost[2, 6, 2]=0.849, max_n_succ_stage=47, Mem: avail=28.031GB, peak=10.004GB, intermediate=0.250GB, init=5.816GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 5, 2]=0.516, max_n_succ_stage=133, Mem: avail=28.031GB, peak=7.628GB, intermediate=0.125GB, init=3.565GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 7, 2]=1.330, max_n_succ_stage=9, Mem: avail=28.031GB, peak=13.923GB, intermediate=0.438GB, init=9.595GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 7, 1]=1.110, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=29.379GB, intermediate=0.219GB, init=9.592GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 5, 3]=0.669, max_n_succ_stage=51, Mem: avail=28.031GB, peak=11.247GB, intermediate=0.250GB, init=3.566GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 6, 1]=0.411, max_n_succ_stage=242, Mem: avail=28.031GB, peak=9.457GB, intermediate=0.062GB, init=3.376GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 7, 1]=0.969, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=25.516GB, intermediate=0.188GB, init=8.359GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 7, 0]=0.750, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=39.635GB, intermediate=0.078GB, init=7.232GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 6, 0]=0.370, max_n_succ_stage=177, Mem: avail=28.031GB, peak=19.067GB, intermediate=0.031GB, init=3.376GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 6, 3]=1.103, max_n_succ_stage=13, Mem: avail=28.031GB, peak=15.201GB, intermediate=0.500GB, init=5.819GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 7, 3]=1.718, max_n_succ_stage=3, Mem: avail=28.031GB, peak=14.738GB, intermediate=0.875GB, init=9.599GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 6, 4]=0.370, max_n_succ_stage=177, Mem: avail=28.031GB, peak=19.067GB, intermediate=0.031GB, init=3.376GB, as_config=((8, 1), {})
cost[2, 7, 4]=0.755, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=38.375GB, intermediate=0.078GB, init=7.232GB, as_config=((8, 1), {})
cost[3, 6, 1]=0.567, max_n_succ_stage=110, Mem: avail=28.031GB, peak=12.927GB, intermediate=0.094GB, init=4.689GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 6, 3]=0.645, max_n_succ_stage=58, Mem: avail=28.031GB, peak=9.766GB, intermediate=0.250GB, init=3.379GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 7, 1]=0.831, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=22.078GB, intermediate=0.156GB, init=7.233GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 6, 2]=0.496, max_n_succ_stage=136, Mem: avail=28.031GB, peak=7.440GB, intermediate=0.125GB, init=3.377GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 7, 3]=1.284, max_n_succ_stage=7, Mem: avail=28.031GB, peak=15.189GB, intermediate=0.625GB, init=7.238GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 6, 4]=0.511, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=26.069GB, intermediate=0.047GB, init=4.689GB, as_config=((8, 1), {})
cost[3, 6, 0]=0.511, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=26.069GB, intermediate=0.047GB, init=4.689GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 6, 2]=0.683, max_n_succ_stage=76, Mem: avail=28.031GB, peak=8.816GB, intermediate=0.188GB, init=4.690GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 7, 0]=0.364, max_n_succ_stage=118, Mem: avail=28.031GB, peak=20.630GB, intermediate=0.031GB, init=3.669GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 7, 3]=0.615, max_n_succ_stage=54, Mem: avail=28.031GB, peak=10.433GB, intermediate=0.250GB, init=3.672GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 7, 1]=0.537, max_n_succ_stage=88, Mem: avail=28.031GB, peak=14.810GB, intermediate=0.094GB, init=4.795GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 7, 0]=0.485, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=26.632GB, intermediate=0.047GB, init=4.794GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 7, 4]=0.368, max_n_succ_stage=158, Mem: avail=28.031GB, peak=19.370GB, intermediate=0.031GB, init=3.669GB, as_config=((8, 1), {})
cost[3, 6, 3]=0.886, max_n_succ_stage=30, Mem: avail=28.031GB, peak=11.701GB, intermediate=0.375GB, init=4.693GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 7, 3]=1.501, max_n_succ_stage=6, Mem: avail=28.031GB, peak=13.992GB, intermediate=0.750GB, init=8.365GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 7, 1]=0.402, max_n_succ_stage=228, Mem: avail=28.031GB, peak=10.020GB, intermediate=0.062GB, init=3.669GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 7, 4]=0.631, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=32.374GB, intermediate=0.062GB, init=6.107GB, as_config=((8, 1), {})
cost[5, 7, 2]=0.479, max_n_succ_stage=131, Mem: avail=28.031GB, peak=7.749GB, intermediate=0.125GB, init=3.670GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 7, 0]=0.626, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=33.634GB, intermediate=0.062GB, init=6.107GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 7, 3]=1.067, max_n_succ_stage=18, Mem: avail=28.031GB, peak=12.094GB, intermediate=0.500GB, init=6.112GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 7, 2]=0.995, max_n_succ_stage=28, Mem: avail=28.031GB, peak=11.501GB, intermediate=0.312GB, init=7.235GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 7, 2]=1.162, max_n_succ_stage=17, Mem: avail=28.031GB, peak=12.689GB, intermediate=0.375GB, init=8.361GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 7, 4]=0.490, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=25.372GB, intermediate=0.047GB, init=4.794GB, as_config=((8, 1), {})
cost[4, 7, 2]=0.641, max_n_succ_stage=75, Mem: avail=28.031GB, peak=8.937GB, intermediate=0.188GB, init=4.796GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 7, 3]=0.826, max_n_succ_stage=32, Mem: avail=28.031GB, peak=10.519GB, intermediate=0.375GB, init=4.798GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 7, 1]=0.693, max_n_succ_stage=25, Mem: avail=28.031GB, peak=18.639GB, intermediate=0.125GB, init=6.108GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 7, 2]=0.828, max_n_succ_stage=45, Mem: avail=28.031GB, peak=10.313GB, intermediate=0.250GB, init=6.109GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
Profiling for submesh 3 (1, 8) takes 364.31 seconds
Profiled costs are: [[[       inf        inf        inf        inf        inf        inf]
  [0.25166047 0.2790805  0.33497585 0.31466621 0.25530827        inf]
  [0.37572809 0.41719598 0.50162936 0.64830065 0.3793759         inf]
  [0.5165926  0.57324442 0.68857685 0.89186819 0.5202404         inf]
  [0.63827782 0.70837487 0.85104759 1.10256322 0.64192562        inf]
  [0.76234545 0.84649035 1.01770091 1.31954196 0.76599326        inf]
  [0.88641307 0.98460583 1.18435422 1.53652071 0.89006088        inf]
  [1.00206275 1.11002036 1.32987449 1.71773043 1.00987845        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [0.38900202 0.4322147  0.52026316 0.67525864 0.38900201        inf]
  [0.51068723 0.56734516 0.68273391 0.88595367 0.51068723        inf]
  [0.63475487 0.70546064 0.84938723 1.10293241 0.63475487        inf]
  [0.75882249 0.84357612 1.01604054 1.31991116 0.75882249        inf]
  [0.87447216 0.96902451 1.16155794 1.50119941 0.87864006        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [0.26493439 0.29409922 0.35360968 0.33333298 0.26493439        inf]
  [0.38661961 0.42922968 0.51608059 0.66897492 0.38661961        inf]
  [0.51068724 0.56734516 0.68273391 0.88595367 0.51068724        inf]
  [0.63475487 0.70546064 0.84938723 1.10293241 0.63475487        inf]
  [0.75040454 0.83090904 0.99490462 1.28422067 0.75457244        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [0.26255198 0.2911142  0.3494271  0.33123261 0.26255198        inf]
  [0.38661962 0.42922969 0.51608059 0.66897492 0.38661962        inf]
  [0.51068724 0.56734516 0.68273391 0.88595367 0.51068724        inf]
  [0.62633692 0.69279356 0.8282513  1.06724192 0.63050481        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [0.36982273 0.41133059 0.49578355 0.64457399 0.36982273        inf]
  [0.48547241 0.53674512 0.64130382 0.82578372 0.48964031        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [0.36378719 0.40161467 0.47883307 0.61508869 0.36795509        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]]
Profiled max_n_succ_stages are: [[[ -1  -1  -1  -1  -1  -1]
  [770 588 310  70 824  -1]
  [156 237 137  53 183  -1]
  [ -1 106  76  28  -1  -1]
  [ -1  46  47  12  -1  -1]
  [ -1  10  30   7  -1  -1]
  [ -1  -1  18   1  -1  -1]
  [ -1  -1   9   3  -1  -1]]

 [[ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [139 232 133  53 168  -1]
  [ -1 110  76  26  -1  -1]
  [ -1  49  47  15  -1  -1]
  [ -1  13  30  10  -1  -1]
  [ -1  -1  17   6  -1  -1]]

 [[ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [793 583 304  46 793  -1]
  [139 232 133  51 168  -1]
  [ -1 110  76  25  -1  -1]
  [ -1  49  47  13  -1  -1]
  [ -1  -1  28   7  -1  -1]]

 [[ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [793 579 303  45 793  -1]
  [139 231 133  51 139  -1]
  [ -1 110  76  30  -1  -1]
  [ -1  25  45  18  -1  -1]]

 [[ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [177 242 136  58 177  -1]
  [ -1  88  75  32  -1  -1]]

 [[ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [118 228 131  54 158  -1]]

 [[ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]]

 [[ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]
  [ -1  -1  -1  -1  -1  -1]]]
--------------------------------------------------
- Profiling for submesh 2 (1, 4):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
cost[0, 1, 0]=0.493, max_n_succ_stage=323, Mem: avail=28.031GB, peak=13.163GB, intermediate=0.031GB, init=4.718GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 0, 1]=0.276, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=8.001GB, intermediate=0.000GB, init=2.468GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 5, 0]=0.481, max_n_succ_stage=359, Mem: avail=28.031GB, peak=12.254GB, intermediate=0.031GB, init=4.501GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 0, 3]=0.253, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=8.503GB, intermediate=0.000GB, init=2.467GB, as_config=((4, 1), {})
cost[4, 5, 3]=0.481, max_n_succ_stage=359, Mem: avail=28.031GB, peak=12.254GB, intermediate=0.031GB, init=4.501GB, as_config=((4, 1), {})
cost[3, 3, 0]=0.276, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=8.317GB, intermediate=0.000GB, init=2.626GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 0, 2]=0.278, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=7.632GB, intermediate=0.000GB, init=4.155GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 3, 3]=0.276, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=8.411GB, intermediate=0.000GB, init=2.626GB, as_config=((4, 1), {})
cost[0, 0, 0]=0.250, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=7.814GB, intermediate=0.000GB, init=2.467GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 3, 1]=0.306, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=7.971GB, intermediate=0.000GB, init=2.626GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 3, 2]=0.343, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=9.284GB, intermediate=0.000GB, init=2.627GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 3, 0]=0.519, max_n_succ_stage=303, Mem: avail=28.031GB, peak=13.628GB, intermediate=0.031GB, init=4.876GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 2, 0]=0.486, max_n_succ_stage=350, Mem: avail=28.031GB, peak=12.534GB, intermediate=0.031GB, init=4.501GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 4, 0]=0.514, max_n_succ_stage=308, Mem: avail=28.031GB, peak=13.472GB, intermediate=0.031GB, init=4.876GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 4, 3]=0.514, max_n_succ_stage=308, Mem: avail=28.031GB, peak=13.472GB, intermediate=0.031GB, init=4.876GB, as_config=((4, 1), {})
cost[1, 2, 1]=0.541, max_n_succ_stage=220, Mem: avail=28.031GB, peak=9.691GB, intermediate=0.062GB, init=4.502GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 2, 3]=0.486, max_n_succ_stage=350, Mem: avail=28.031GB, peak=12.534GB, intermediate=0.031GB, init=4.501GB, as_config=((4, 1), {})
cost[1, 2, 2]=0.537, max_n_succ_stage=41, Mem: avail=28.031GB, peak=13.777GB, intermediate=0.125GB, init=9.001GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 1, 2]=0.547, max_n_succ_stage=46, Mem: avail=28.031GB, peak=13.436GB, intermediate=0.125GB, init=8.655GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 4, 2]=0.574, max_n_succ_stage=33, Mem: avail=28.031GB, peak=14.285GB, intermediate=0.125GB, init=9.376GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 5, 0]=0.757, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=21.505GB, intermediate=0.062GB, init=7.127GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 5, 2]=0.535, max_n_succ_stage=34, Mem: avail=28.031GB, peak=14.537GB, intermediate=0.125GB, init=9.001GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 4, 1]=0.571, max_n_succ_stage=203, Mem: avail=28.031GB, peak=10.347GB, intermediate=0.062GB, init=4.877GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 1, 3]=0.496, max_n_succ_stage=321, Mem: avail=28.031GB, peak=13.221GB, intermediate=0.031GB, init=4.718GB, as_config=((4, 1), {})
cost[2, 3, 2]=0.578, max_n_succ_stage=31, Mem: avail=28.031GB, peak=14.597GB, intermediate=0.125GB, init=9.376GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 3, 3]=0.519, max_n_succ_stage=303, Mem: avail=28.031GB, peak=13.628GB, intermediate=0.031GB, init=4.876GB, as_config=((4, 1), {})
cost[0, 1, 1]=0.547, max_n_succ_stage=212, Mem: avail=28.031GB, peak=9.986GB, intermediate=0.062GB, init=4.718GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 6, 0]=0.486, max_n_succ_stage=355, Mem: avail=28.031GB, peak=12.379GB, intermediate=0.031GB, init=4.501GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 3, 1]=0.577, max_n_succ_stage=208, Mem: avail=28.031GB, peak=10.066GB, intermediate=0.062GB, init=4.877GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 5, 1]=0.535, max_n_succ_stage=218, Mem: avail=28.031GB, peak=9.785GB, intermediate=0.062GB, init=4.502GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 4, 0]=0.757, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=21.630GB, intermediate=0.062GB, init=7.127GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 3, 2]=1.009, max_n_succ_stage=17, Mem: avail=28.031GB, peak=16.198GB, intermediate=0.250GB, init=7.129GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 3, 0]=0.762, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=21.630GB, intermediate=0.062GB, init=7.127GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 6, 2]=0.961, max_n_succ_stage=29, Mem: avail=28.031GB, peak=13.573GB, intermediate=0.250GB, init=6.754GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 6, 1]=0.806, max_n_succ_stage=73, Mem: avail=28.031GB, peak=11.973GB, intermediate=0.125GB, init=6.753GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 2, 3]=0.739, max_n_succ_stage=28, Mem: avail=28.031GB, peak=19.192GB, intermediate=0.062GB, init=6.969GB, as_config=((4, 1), {})
cost[5, 6, 3]=0.486, max_n_succ_stage=355, Mem: avail=28.031GB, peak=12.379GB, intermediate=0.031GB, init=4.501GB, as_config=((4, 1), {})
cost[0, 2, 0]=0.735, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=21.290GB, intermediate=0.062GB, init=6.969GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 4, 3]=0.757, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=21.724GB, intermediate=0.062GB, init=7.127GB, as_config=((4, 1), {})
cost[5, 6, 2]=0.540, max_n_succ_stage=40, Mem: avail=28.031GB, peak=13.785GB, intermediate=0.125GB, init=9.001GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 5, 3]=0.757, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=21.505GB, intermediate=0.062GB, init=7.127GB, as_config=((4, 1), {})
cost[5, 6, 1]=0.541, max_n_succ_stage=214, Mem: avail=28.031GB, peak=10.066GB, intermediate=0.062GB, init=4.502GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 4, 2]=1.001, max_n_succ_stage=18, Mem: avail=28.031GB, peak=15.983GB, intermediate=0.250GB, init=7.129GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 5, 2]=1.001, max_n_succ_stage=17, Mem: avail=28.031GB, peak=16.358GB, intermediate=0.250GB, init=7.129GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[6, 7, 0]=0.470, max_n_succ_stage=286, Mem: avail=28.031GB, peak=13.972GB, intermediate=0.031GB, init=5.087GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 3, 3]=0.762, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=21.724GB, intermediate=0.062GB, init=7.127GB, as_config=((4, 1), {})
cost[4, 6, 0]=0.724, max_n_succ_stage=14, Mem: avail=28.031GB, peak=20.286GB, intermediate=0.062GB, init=6.752GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 6, 3]=0.724, max_n_succ_stage=14, Mem: avail=28.031GB, peak=20.286GB, intermediate=0.062GB, init=6.752GB, as_config=((4, 1), {})
cost[5, 7, 0]=0.712, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=22.177GB, intermediate=0.062GB, init=7.338GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[6, 7, 3]=0.473, max_n_succ_stage=308, Mem: avail=28.031GB, peak=13.281GB, intermediate=0.031GB, init=5.087GB, as_config=((4, 1), {})
cost[1, 3, 1]=0.847, max_n_succ_stage=67, Mem: avail=28.031GB, peak=12.317GB, intermediate=0.125GB, init=7.128GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 5, 1]=0.842, max_n_succ_stage=65, Mem: avail=28.031GB, peak=12.536GB, intermediate=0.125GB, init=7.128GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 2, 2]=0.970, max_n_succ_stage=20, Mem: avail=28.031GB, peak=15.689GB, intermediate=0.250GB, init=6.971GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[6, 7, 2]=0.500, max_n_succ_stage=57, Mem: avail=28.031GB, peak=13.375GB, intermediate=0.125GB, init=7.337GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 2, 1]=0.818, max_n_succ_stage=70, Mem: avail=28.031GB, peak=12.174GB, intermediate=0.125GB, init=6.969GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[6, 7, 1]=0.517, max_n_succ_stage=201, Mem: avail=28.031GB, peak=10.277GB, intermediate=0.062GB, init=5.088GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 4, 1]=0.842, max_n_succ_stage=68, Mem: avail=28.031GB, peak=12.254GB, intermediate=0.125GB, init=7.128GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 7, 1]=0.787, max_n_succ_stage=62, Mem: avail=28.031GB, peak=12.723GB, intermediate=0.125GB, init=7.339GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 7, 3]=0.716, max_n_succ_stage=1, Mem: avail=28.031GB, peak=20.517GB, intermediate=0.062GB, init=7.338GB, as_config=((4, 1), {})
cost[4, 7, 3]=0.954, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=27.519GB, intermediate=0.094GB, init=9.589GB, as_config=((4, 1), {})
cost[4, 7, 0]=0.951, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=27.569GB, intermediate=0.094GB, init=9.588GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 7, 2]=0.929, max_n_succ_stage=27, Mem: avail=28.031GB, peak=13.485GB, intermediate=0.250GB, init=7.340GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 7, 2]=1.244, max_n_succ_stage=6, Mem: avail=28.031GB, peak=15.613GB, intermediate=0.375GB, init=9.592GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 7, 1]=1.052, max_n_succ_stage=19, Mem: avail=28.031GB, peak=14.630GB, intermediate=0.188GB, init=9.590GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
Profiling for submesh 2 (1, 4) takes 172.62 seconds
Profiled costs are: [[[0.24984232 0.27642354 0.27772559 0.25292984        inf        inf]
  [0.49264338 0.546975   0.54742394 0.4957309         inf        inf]
  [0.73544444 0.8175273  0.96992727 0.73853196        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [0.48560412 0.54118911 0.53660652 0.48560412        inf        inf]
  [0.76185695 0.8474718  1.0088527  0.76185695        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [0.51905589 0.5769195  0.57824526 0.51905589        inf        inf]
  [0.75709269 0.84153425 1.00072628 0.75709269        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [0.27625484 0.30636779 0.34329403 0.27625483        inf        inf]
  [0.51429163 0.57098194 0.57363257 0.51429163        inf        inf]
  [0.75709269 0.84153425 1.00072628 0.75709269        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [0.48083987 0.53521076 0.53493758 0.48083987        inf        inf]
  [0.72364092 0.80576307 0.96058472 0.72364092        inf        inf]
  [0.95052489 1.0520952  1.24385031 0.95430045        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [0.48560413 0.54114832 0.53955028 0.48560413        inf        inf]
  [0.7124881  0.78748045 0.92909549 0.71626366        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [0.46968703 0.51691982 0.50035989 0.4734626         inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]]
Profiled max_n_succ_stages are: [[[4096 4096 4096 4096   -1   -1]
  [ 323  212   46  321   -1   -1]
  [  -1   70   20   28   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [ 350  220   41  350   -1   -1]
  [  -1   67   17   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [ 303  208   31  303   -1   -1]
  [  -1   68   18   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [4096 4096 4096 4096   -1   -1]
  [ 308  203   33  308   -1   -1]
  [  -1   65   17   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [ 359  218   34  359   -1   -1]
  [  14   73   29   14   -1   -1]
  [  -1   19    6   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [ 355  214   40  355   -1   -1]
  [  -1   62   27    1   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [ 286  201   57  308   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]]
--------------------------------------------------
- Profiling for submesh 1 (1, 2):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
cost[6, 6, 0]=0.477, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=12.441GB, intermediate=0.000GB, init=4.501GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 4, 0]=0.468, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=12.191GB, intermediate=0.000GB, init=4.501GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[6, 6, 1]=0.522, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=13.502GB, intermediate=0.000GB, init=4.502GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[7, 7, 1]=0.485, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=15.151GB, intermediate=0.000GB, init=5.674GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[7, 7, 0]=0.447, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=14.552GB, intermediate=0.000GB, init=5.673GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[7, 7, 2]=0.450, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=14.369GB, intermediate=0.000GB, init=5.673GB, as_config=((2, 1), {})
cost[4, 4, 1]=0.510, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=13.128GB, intermediate=0.000GB, init=4.502GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 3, 1]=0.593, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=14.127GB, intermediate=0.000GB, init=5.252GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 0, 1]=0.511, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=12.688GB, intermediate=0.000GB, init=6.060GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 0, 0]=0.491, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=12.594GB, intermediate=0.000GB, init=4.935GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 0, 2]=0.497, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=13.048GB, intermediate=0.000GB, init=4.935GB, as_config=((2, 1), {})
cost[5, 5, 2]=0.477, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=12.504GB, intermediate=0.000GB, init=4.501GB, as_config=((2, 1), {})
cost[1, 1, 0]=0.477, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=12.066GB, intermediate=0.000GB, init=4.501GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 2, 2]=0.477, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=12.066GB, intermediate=0.000GB, init=4.501GB, as_config=((2, 1), {})
cost[1, 1, 2]=0.477, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=12.066GB, intermediate=0.000GB, init=4.501GB, as_config=((2, 1), {})
cost[2, 2, 1]=0.523, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=13.065GB, intermediate=0.000GB, init=4.502GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 2, 0]=0.477, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=12.066GB, intermediate=0.000GB, init=4.501GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 5, 1]=0.522, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=14.004GB, intermediate=0.000GB, init=4.502GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 4, 2]=0.468, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=12.254GB, intermediate=0.000GB, init=4.501GB, as_config=((2, 1), {})
cost[1, 1, 1]=0.523, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=13.065GB, intermediate=0.000GB, init=4.502GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[6, 6, 2]=0.477, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=12.441GB, intermediate=0.000GB, init=4.501GB, as_config=((2, 1), {})
cost[3, 3, 2]=0.543, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=13.441GB, intermediate=0.000GB, init=5.251GB, as_config=((2, 1), {})
cost[5, 5, 0]=0.477, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=12.504GB, intermediate=0.000GB, init=4.501GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 3, 0]=0.543, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=13.379GB, intermediate=0.000GB, init=5.251GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[6, 7, 1]=0.945, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=18.560GB, intermediate=0.125GB, init=11.675GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[6, 7, 2]=0.927, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=18.435GB, intermediate=0.062GB, init=10.175GB, as_config=((2, 1), {})
cost[6, 7, 0]=0.924, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=18.363GB, intermediate=0.062GB, init=10.175GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 2, 2]=0.954, max_n_succ_stage=36, Mem: avail=28.031GB, peak=16.692GB, intermediate=0.062GB, init=9.002GB, as_config=((2, 1), {})
cost[4, 5, 2]=0.944, max_n_succ_stage=34, Mem: avail=28.031GB, peak=16.818GB, intermediate=0.062GB, init=9.002GB, as_config=((2, 1), {})
cost[4, 5, 1]=0.981, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=20.197GB, intermediate=0.125GB, init=12.002GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 6, 2]=0.954, max_n_succ_stage=29, Mem: avail=28.031GB, peak=17.130GB, intermediate=0.062GB, init=9.002GB, as_config=((2, 1), {})
cost[1, 2, 0]=0.954, max_n_succ_stage=36, Mem: avail=28.031GB, peak=16.692GB, intermediate=0.062GB, init=9.002GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 2, 1]=0.989, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=19.303GB, intermediate=0.125GB, init=12.002GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 6, 1]=0.991, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=19.818GB, intermediate=0.125GB, init=12.002GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 6, 0]=0.954, max_n_succ_stage=29, Mem: avail=28.031GB, peak=17.130GB, intermediate=0.062GB, init=9.002GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 5, 0]=0.944, max_n_succ_stage=34, Mem: avail=28.031GB, peak=16.818GB, intermediate=0.062GB, init=9.002GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
Profiling for submesh 1 (1, 2) takes 70.21 seconds
Profiled costs are: [[[0.49129806 0.51077368 0.49688634        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [0.47698751 0.52274818 0.47698751        inf        inf        inf]
  [0.95397288 0.98896917 0.95397288        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [0.47698751 0.52274818 0.47698751        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [0.54342121 0.59272776 0.5434212         inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [0.4675067  0.5100729  0.4675067         inf        inf        inf]
  [0.94449208 0.98127374 0.94449208        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [0.47698751 0.52184027 0.47698751        inf        inf        inf]
  [0.95397289 0.99065624 0.95397289        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [0.47698751 0.52184027 0.47698751        inf        inf        inf]
  [0.92393728 0.94511055 0.92681802        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [0.44695191 0.48536315 0.44983265        inf        inf        inf]]]
Profiled max_n_succ_stages are: [[[4096 4096 4096   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [4096 4096 4096   -1   -1   -1]
  [  36   -1   36   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [4096 4096 4096   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [4096 4096 4096   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [4096 4096 4096   -1   -1   -1]
  [  34   -1   34   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [4096 4096 4096   -1   -1   -1]
  [  29   -1   29   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [4096 4096 4096   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1   -1]
  [4096 4096 4096   -1   -1   -1]]]
--------------------------------------------------
- Profiling for submesh 0 (1, 1):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
cost[7, 7, 1]=0.892, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=24.301GB, intermediate=0.000GB, init=11.347GB, as_config=((1, 1), {})
cost[7, 7, 0]=0.892, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=24.301GB, intermediate=0.000GB, init=11.347GB, as_config=((1, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 2, 1]=0.952, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=20.127GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {})
cost[6, 6, 1]=0.952, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=20.877GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {})
cost[6, 6, 0]=0.952, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=20.877GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 1, 0]=0.952, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=20.127GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 4, 0]=0.933, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=20.379GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 4, 1]=0.933, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=20.379GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {})
cost[1, 1, 1]=0.952, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=20.127GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {})
cost[2, 2, 0]=0.952, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=20.127GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 5, 0]=0.952, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=21.004GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 5, 1]=0.952, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=21.004GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {})
Profiling for submesh 0 (1, 1) takes 24.80 seconds
Profiled costs are: [[[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [0.95224424 0.95224424        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [0.95224424 0.95224424        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [0.93326467 0.93326467        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [0.95224424 0.95224424        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [0.95224424 0.95224424        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf        inf]
  [0.89223115 0.89223115        inf        inf        inf        inf]]]
Profiled max_n_succ_stages are: [[[-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]]

 [[-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]]

 [[-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]]

 [[-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]]

 [[-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]]

 [[-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]]

 [[-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]]

 [[-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]
  [-1 -1 -1 -1 -1 -1]]]
--------------------------------------------------
Compute cost saved to: compute-cost-2022-11-12-03-24-17.npy
----------------------------------------------------------------------
Result forward_stage_layer_ids: [[0, 1], [2, 3], [4, 5], [6, 7]]
Result mesh_shapes: [(1, 4), (1, 4), (1, 4), (1, 4)]
Result logical_mesh_shapes: [(4, 1), (4, 1), (4, 1), (4, 1)]
Result autosharding_option_dicts: [{'force_batch_dim_to_mesh_dim': 0}, {}, {'force_batch_dim_to_mesh_dim': 0}, {'force_batch_dim_to_mesh_dim': 0}]
 - Compile (driver): 832.01 s
compilation time breakdown: {'stage-construction': '744.33', 'stage-construction-dp': '1.65', 'stage-construction-compilation': '518.37', 'stage-construction-profiling': '220.52'}
 - Compile (worker): 34.46 s
Iteration 0 ...
Iteration 1 ...
Iteration 2 ...
 - Benchmark: 165.65 s
Type: gpt  Model Config: GPTModelConfig(seq_len=1024, hidden_size=4096, num_layers=32, num_heads=32, vocab_size=51200)  #Microbatch: 64  #GPU: 16  Parallel Config: SearchParallelArgs(prefer_reduce_scatter=True, use_remat=True, num_auto_layers=8, auto_stage_option={'submesh_physical_shape_space': 'small_power_of_two', 'submesh_logical_shape_space': 'all', 'stage_imbalance_tolerance': 1.0, 'use_hlo_cost_model': True, 'profiling_database_filename': 'prof_database.pkl'})  Mean Time (s): 46.193  Std Time (s): 0.063  #Params (Billion): 6.654B  TFLOPs: 77.95  Peak Mem (GB): 16.751  Metadata: {'compilation_times': "{'stage-construction': '744.33', 'stage-construction-dp': '1.65', 'stage-construction-compilation': '518.37', 'stage-construction-profiling': '220.52'}", 'compute_cost_file_name': 'compute-cost-2022-11-12-03-24-17.npy', 'forward_stage_layer_ids': '[[0, 1], [2, 3], [4, 5], [6, 7]]', 'submesh_shapes': '[[1, 4], [1, 4], [1, 4], [1, 4]]', 'logical_mesh_shapes': '[[4, 1], [4, 1], [4, 1], [4, 1]]', 'autosharding_option_dicts': "[{'force_batch_dim_to_mesh_dim': '0'}, {}, {'force_batch_dim_to_mesh_dim': '0'}, {'force_batch_dim_to_mesh_dim': '0'}]"}  
Working on case: BenchmarkCase(batch_size=1024, model_config=GPTModelConfig(seq_len=1024, hidden_size=4096, num_layers=32, num_heads=32, vocab_size=51200), num_micro_batches=128, parallel_mode='search', parallel_args=SearchParallelArgs(prefer_reduce_scatter=True, use_remat=True, num_auto_layers=8, auto_stage_option={'submesh_physical_shape_space': 'small_power_of_two', 'submesh_logical_shape_space': 'all', 'stage_imbalance_tolerance': 1.0, 'use_hlo_cost_model': True, 'profiling_database_filename': 'prof_database.pkl'}))
 - Prepare input: 0.05 s
 - Create train state: 7.17 s
-------------------- Automatic stage clustering --------------------
submesh_choices: ((1, 1), (1, 2), (1, 4), (1, 8), (1, 16))
- Profiling for submesh 4 (1, 16):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
cost[0, 7, 1]=0.371, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=13.293GB, intermediate=0.000GB, init=4.797GB, as_config=((4, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 7, 2]=0.473, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=6.461GB, intermediate=0.000GB, init=4.800GB, as_config=((2, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 7, 4]=0.740, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=6.759GB, intermediate=0.000GB, init=4.804GB, as_config=((16, 1), {})
cost[0, 7, 0]=0.319, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=26.033GB, intermediate=0.000GB, init=4.796GB, as_config=((8, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 7, 3]=0.740, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=6.759GB, intermediate=0.000GB, init=4.804GB, as_config=((1, 16), {'force_batch_dim_to_mesh_dim': 0})
Profiling for submesh 4 (1, 16) takes 104.74 seconds
Profiled costs are: [[[       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [0.31915843 0.37135694 0.47296254 0.74007857 0.74007857]]

 [[       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]]]
Profiled max_n_succ_stages are: [[[  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1 4096 4096 4096 4096]]

 [[  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]]]
--------------------------------------------------
- Profiling for submesh 3 (1, 8):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
cost[0, 1, 0]=0.133, max_n_succ_stage=1640, Mem: avail=28.031GB, peak=12.847GB, intermediate=0.008GB, init=2.359GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 1, 2]=0.174, max_n_succ_stage=691, Mem: avail=28.031GB, peak=4.027GB, intermediate=0.031GB, init=2.360GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 1, 3]=0.225, max_n_succ_stage=327, Mem: avail=28.031GB, peak=5.154GB, intermediate=0.062GB, init=2.361GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 1, 1]=0.148, max_n_succ_stage=1226, Mem: avail=28.031GB, peak=6.494GB, intermediate=0.016GB, init=2.359GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 3, 1]=0.230, max_n_succ_stage=469, Mem: avail=28.031GB, peak=9.769GB, intermediate=0.031GB, init=3.564GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 3, 2]=0.271, max_n_succ_stage=304, Mem: avail=28.031GB, peak=5.370GB, intermediate=0.062GB, init=3.565GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 1, 4]=0.225, max_n_succ_stage=327, Mem: avail=28.031GB, peak=5.164GB, intermediate=0.062GB, init=2.361GB, as_config=((8, 1), {})
cost[1, 3, 0]=0.207, max_n_succ_stage=324, Mem: avail=28.031GB, peak=19.380GB, intermediate=0.016GB, init=3.563GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 2, 2]=0.260, max_n_succ_stage=307, Mem: avail=28.031GB, peak=5.246GB, intermediate=0.062GB, init=3.485GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 2, 1]=0.221, max_n_succ_stage=480, Mem: avail=28.031GB, peak=9.496GB, intermediate=0.031GB, init=3.485GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 2, 3]=0.339, max_n_succ_stage=144, Mem: avail=28.031GB, peak=6.377GB, intermediate=0.125GB, init=3.487GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 2, 4]=0.338, max_n_succ_stage=144, Mem: avail=28.031GB, peak=6.373GB, intermediate=0.125GB, init=3.487GB, as_config=((8, 1), {})
cost[1, 4, 3]=0.463, max_n_succ_stage=82, Mem: avail=28.031GB, peak=7.727GB, intermediate=0.188GB, init=4.693GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 2, 0]=0.200, max_n_succ_stage=361, Mem: avail=28.031GB, peak=18.880GB, intermediate=0.016GB, init=3.484GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 3, 4]=0.353, max_n_succ_stage=144, Mem: avail=28.031GB, peak=6.319GB, intermediate=0.125GB, init=3.566GB, as_config=((8, 1), {})
cost[1, 3, 3]=0.353, max_n_succ_stage=144, Mem: avail=28.031GB, peak=6.319GB, intermediate=0.125GB, init=3.566GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 3, 0]=0.275, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=25.975GB, intermediate=0.023GB, init=4.797GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 4, 2]=0.355, max_n_succ_stage=177, Mem: avail=28.031GB, peak=6.621GB, intermediate=0.094GB, init=4.690GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 4, 0]=0.272, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=25.444GB, intermediate=0.023GB, init=4.689GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 3, 1]=0.304, max_n_succ_stage=216, Mem: avail=28.031GB, peak=13.059GB, intermediate=0.047GB, init=4.798GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 4, 1]=0.302, max_n_succ_stage=223, Mem: avail=28.031GB, peak=12.817GB, intermediate=0.047GB, init=4.689GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 3, 4]=0.465, max_n_succ_stage=84, Mem: avail=28.031GB, peak=7.270GB, intermediate=0.188GB, init=4.801GB, as_config=((8, 1), {})
cost[1, 5, 0]=0.338, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=31.571GB, intermediate=0.031GB, init=5.814GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 4, 4]=0.463, max_n_succ_stage=82, Mem: avail=28.031GB, peak=7.727GB, intermediate=0.188GB, init=4.693GB, as_config=((8, 1), {})
cost[0, 3, 3]=0.465, max_n_succ_stage=84, Mem: avail=28.031GB, peak=7.270GB, intermediate=0.188GB, init=4.801GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 3, 0]=0.141, max_n_succ_stage=1575, Mem: avail=28.031GB, peak=13.277GB, intermediate=0.008GB, init=2.438GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 3, 2]=0.358, max_n_succ_stage=175, Mem: avail=28.031GB, peak=6.685GB, intermediate=0.094GB, init=4.799GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 4, 0]=0.340, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=32.133GB, intermediate=0.031GB, init=5.922GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 3, 2]=0.184, max_n_succ_stage=685, Mem: avail=28.031GB, peak=4.143GB, intermediate=0.031GB, init=2.439GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 3, 1]=0.156, max_n_succ_stage=1202, Mem: avail=28.031GB, peak=6.784GB, intermediate=0.016GB, init=2.438GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 4, 3]=0.575, max_n_succ_stage=50, Mem: avail=28.031GB, peak=9.184GB, intermediate=0.250GB, init=5.927GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 4, 2]=0.442, max_n_succ_stage=110, Mem: avail=28.031GB, peak=8.154GB, intermediate=0.125GB, init=5.924GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 4, 1]=0.376, max_n_succ_stage=95, Mem: avail=28.031GB, peak=16.107GB, intermediate=0.062GB, init=5.923GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 4, 4]=0.575, max_n_succ_stage=50, Mem: avail=28.031GB, peak=9.184GB, intermediate=0.250GB, init=5.927GB, as_config=((8, 1), {})
cost[1, 5, 1]=0.375, max_n_succ_stage=100, Mem: avail=28.031GB, peak=15.881GB, intermediate=0.062GB, init=5.815GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 3, 4]=0.239, max_n_succ_stage=326, Mem: avail=28.031GB, peak=5.152GB, intermediate=0.062GB, init=2.440GB, as_config=((8, 1), {})
cost[2, 3, 3]=0.239, max_n_succ_stage=326, Mem: avail=28.031GB, peak=5.152GB, intermediate=0.062GB, init=2.440GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 5, 0]=0.406, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=38.260GB, intermediate=0.039GB, init=7.048GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 4, 0]=0.206, max_n_succ_stage=328, Mem: avail=28.031GB, peak=19.317GB, intermediate=0.016GB, init=3.563GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 4, 1]=0.228, max_n_succ_stage=469, Mem: avail=28.031GB, peak=9.769GB, intermediate=0.031GB, init=3.564GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 5, 3]=0.576, max_n_succ_stage=53, Mem: avail=28.031GB, peak=8.534GB, intermediate=0.250GB, init=5.819GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 5, 4]=0.576, max_n_succ_stage=53, Mem: avail=28.031GB, peak=8.534GB, intermediate=0.250GB, init=5.819GB, as_config=((8, 1), {})
cost[1, 5, 2]=0.442, max_n_succ_stage=111, Mem: avail=28.031GB, peak=8.091GB, intermediate=0.125GB, init=5.816GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 4, 3]=0.349, max_n_succ_stage=142, Mem: avail=28.031GB, peak=6.517GB, intermediate=0.125GB, init=3.566GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 4, 2]=0.269, max_n_succ_stage=304, Mem: avail=28.031GB, peak=5.402GB, intermediate=0.062GB, init=3.565GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 4, 4]=0.349, max_n_succ_stage=142, Mem: avail=28.031GB, peak=6.517GB, intermediate=0.125GB, init=3.566GB, as_config=((8, 1), {})
cost[0, 5, 2]=0.529, max_n_succ_stage=71, Mem: avail=28.031GB, peak=9.655GB, intermediate=0.156GB, init=7.050GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 5, 3]=0.688, max_n_succ_stage=34, Mem: avail=28.031GB, peak=9.746GB, intermediate=0.312GB, init=7.054GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 5, 1]=0.450, max_n_succ_stage=22, Mem: avail=28.031GB, peak=19.171GB, intermediate=0.078GB, init=7.049GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 5, 0]=0.272, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=25.444GB, intermediate=0.023GB, init=4.689GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 5, 4]=0.688, max_n_succ_stage=34, Mem: avail=28.031GB, peak=9.746GB, intermediate=0.312GB, init=7.054GB, as_config=((8, 1), {})
cost[1, 6, 0]=0.405, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=37.697GB, intermediate=0.039GB, init=6.939GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 6, 0]=0.472, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=44.386GB, intermediate=0.047GB, init=8.173GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 4, 0]=0.140, max_n_succ_stage=1579, Mem: avail=28.031GB, peak=13.246GB, intermediate=0.008GB, init=2.438GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 5, 1]=0.302, max_n_succ_stage=223, Mem: avail=28.031GB, peak=12.817GB, intermediate=0.047GB, init=4.689GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 5, 3]=0.463, max_n_succ_stage=81, Mem: avail=28.031GB, peak=7.852GB, intermediate=0.188GB, init=4.693GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 4, 2]=0.182, max_n_succ_stage=682, Mem: avail=28.031GB, peak=4.221GB, intermediate=0.031GB, init=2.439GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 5, 2]=0.355, max_n_succ_stage=177, Mem: avail=28.031GB, peak=6.621GB, intermediate=0.094GB, init=4.690GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 4, 1]=0.155, max_n_succ_stage=1202, Mem: avail=28.031GB, peak=6.784GB, intermediate=0.016GB, init=2.438GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 4, 4]=0.236, max_n_succ_stage=326, Mem: avail=28.031GB, peak=5.132GB, intermediate=0.062GB, init=2.440GB, as_config=((8, 1), {})
cost[3, 4, 3]=0.236, max_n_succ_stage=326, Mem: avail=28.031GB, peak=5.132GB, intermediate=0.062GB, init=2.440GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 6, 1]=0.449, max_n_succ_stage=26, Mem: avail=28.031GB, peak=18.945GB, intermediate=0.078GB, init=6.940GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 5, 4]=0.463, max_n_succ_stage=81, Mem: avail=28.031GB, peak=7.852GB, intermediate=0.188GB, init=4.693GB, as_config=((8, 1), {})
cost[1, 6, 2]=0.529, max_n_succ_stage=72, Mem: avail=28.031GB, peak=9.592GB, intermediate=0.156GB, init=6.942GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 6, 1]=0.523, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=22.219GB, intermediate=0.094GB, init=8.174GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 7, 0]=0.466, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=45.371GB, intermediate=0.047GB, init=8.358GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 6, 3]=0.802, max_n_succ_stage=22, Mem: avail=28.031GB, peak=10.963GB, intermediate=0.375GB, init=8.180GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 6, 2]=0.615, max_n_succ_stage=45, Mem: avail=28.031GB, peak=11.156GB, intermediate=0.188GB, init=8.176GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 6, 3]=0.689, max_n_succ_stage=38, Mem: avail=28.031GB, peak=8.761GB, intermediate=0.312GB, init=6.945GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 5, 1]=0.228, max_n_succ_stage=469, Mem: avail=28.031GB, peak=9.769GB, intermediate=0.031GB, init=3.564GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 6, 2]=0.442, max_n_succ_stage=111, Mem: avail=28.031GB, peak=8.091GB, intermediate=0.125GB, init=5.816GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 6, 4]=0.802, max_n_succ_stage=22, Mem: avail=28.031GB, peak=10.963GB, intermediate=0.375GB, init=8.180GB, as_config=((8, 1), {})
cost[3, 5, 0]=0.206, max_n_succ_stage=328, Mem: avail=28.031GB, peak=19.318GB, intermediate=0.016GB, init=3.563GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 7, 0]=0.533, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=52.060GB, intermediate=0.055GB, init=9.591GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 6, 4]=0.689, max_n_succ_stage=38, Mem: avail=28.031GB, peak=8.761GB, intermediate=0.312GB, init=6.945GB, as_config=((8, 1), {})
cost[3, 5, 4]=0.349, max_n_succ_stage=142, Mem: avail=28.031GB, peak=6.517GB, intermediate=0.125GB, init=3.566GB, as_config=((8, 1), {})
cost[2, 7, 0]=0.399, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=39.245GB, intermediate=0.039GB, init=7.232GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 5, 2]=0.269, max_n_succ_stage=303, Mem: avail=28.031GB, peak=5.433GB, intermediate=0.062GB, init=3.565GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 7, 2]=0.691, max_n_succ_stage=15, Mem: avail=28.031GB, peak=14.755GB, intermediate=0.219GB, init=9.595GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 5, 3]=0.349, max_n_succ_stage=142, Mem: avail=28.031GB, peak=6.517GB, intermediate=0.125GB, init=3.566GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 6, 1]=0.375, max_n_succ_stage=100, Mem: avail=28.031GB, peak=15.881GB, intermediate=0.062GB, init=5.815GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 6, 0]=0.338, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=31.571GB, intermediate=0.031GB, init=5.814GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 7, 3]=0.896, max_n_succ_stage=18, Mem: avail=28.031GB, peak=9.782GB, intermediate=0.438GB, init=9.599GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 7, 3]=0.784, max_n_succ_stage=27, Mem: avail=28.031GB, peak=9.099GB, intermediate=0.375GB, init=8.365GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 7, 2]=0.604, max_n_succ_stage=34, Mem: avail=28.031GB, peak=12.980GB, intermediate=0.188GB, init=8.361GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 6, 4]=0.576, max_n_succ_stage=51, Mem: avail=28.031GB, peak=9.060GB, intermediate=0.250GB, init=5.819GB, as_config=((8, 1), {})
cost[0, 7, 1]=0.589, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=26.439GB, intermediate=0.109GB, init=9.592GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 6, 0]=0.197, max_n_succ_stage=404, Mem: avail=28.031GB, peak=18.317GB, intermediate=0.016GB, init=3.376GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 6, 3]=0.576, max_n_succ_stage=51, Mem: avail=28.031GB, peak=9.060GB, intermediate=0.250GB, init=5.819GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 7, 1]=0.515, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=22.712GB, intermediate=0.094GB, init=8.359GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 6, 0]=0.272, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=25.444GB, intermediate=0.023GB, init=4.689GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 6, 1]=0.219, max_n_succ_stage=492, Mem: avail=28.031GB, peak=9.238GB, intermediate=0.031GB, init=3.376GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 6, 2]=0.258, max_n_succ_stage=310, Mem: avail=28.031GB, peak=5.183GB, intermediate=0.062GB, init=3.377GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 7, 4]=0.896, max_n_succ_stage=18, Mem: avail=28.031GB, peak=9.782GB, intermediate=0.438GB, init=9.599GB, as_config=((8, 1), {})
cost[1, 7, 4]=0.784, max_n_succ_stage=27, Mem: avail=28.031GB, peak=9.099GB, intermediate=0.375GB, init=8.365GB, as_config=((8, 1), {})
cost[4, 6, 4]=0.337, max_n_succ_stage=150, Mem: avail=28.031GB, peak=5.734GB, intermediate=0.125GB, init=3.379GB, as_config=((8, 1), {})
cost[4, 6, 3]=0.337, max_n_succ_stage=150, Mem: avail=28.031GB, peak=5.734GB, intermediate=0.125GB, init=3.379GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 7, 1]=0.441, max_n_succ_stage=13, Mem: avail=28.031GB, peak=19.664GB, intermediate=0.078GB, init=7.233GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 6, 3]=0.463, max_n_succ_stage=85, Mem: avail=28.031GB, peak=7.038GB, intermediate=0.188GB, init=4.693GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 6, 1]=0.302, max_n_succ_stage=223, Mem: avail=28.031GB, peak=12.817GB, intermediate=0.047GB, init=4.689GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 7, 4]=0.670, max_n_succ_stage=35, Mem: avail=28.031GB, peak=9.405GB, intermediate=0.312GB, init=7.238GB, as_config=((8, 1), {})
cost[5, 7, 1]=0.213, max_n_succ_stage=442, Mem: avail=28.031GB, peak=10.504GB, intermediate=0.031GB, init=3.669GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 7, 0]=0.193, max_n_succ_stage=286, Mem: avail=28.031GB, peak=19.865GB, intermediate=0.016GB, init=3.669GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 6, 2]=0.355, max_n_succ_stage=177, Mem: avail=28.031GB, peak=6.621GB, intermediate=0.094GB, init=4.690GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 6, 4]=0.463, max_n_succ_stage=85, Mem: avail=28.031GB, peak=7.038GB, intermediate=0.188GB, init=4.693GB, as_config=((8, 1), {})
cost[5, 7, 2]=0.249, max_n_succ_stage=301, Mem: avail=28.031GB, peak=5.448GB, intermediate=0.062GB, init=3.670GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 7, 3]=0.321, max_n_succ_stage=144, Mem: avail=28.031GB, peak=6.141GB, intermediate=0.125GB, init=3.672GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 7, 2]=0.517, max_n_succ_stage=59, Mem: avail=28.031GB, peak=11.354GB, intermediate=0.156GB, init=7.235GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 7, 3]=0.670, max_n_succ_stage=35, Mem: avail=28.031GB, peak=9.405GB, intermediate=0.312GB, init=7.238GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 7, 0]=0.333, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=33.118GB, intermediate=0.031GB, init=6.107GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 7, 4]=0.321, max_n_succ_stage=144, Mem: avail=28.031GB, peak=6.141GB, intermediate=0.125GB, init=3.672GB, as_config=((8, 1), {})
cost[4, 7, 0]=0.258, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=25.991GB, intermediate=0.023GB, init=4.794GB, as_config=((8, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 7, 2]=0.333, max_n_succ_stage=176, Mem: avail=28.031GB, peak=6.637GB, intermediate=0.094GB, init=4.796GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 7, 3]=0.557, max_n_succ_stage=56, Mem: avail=28.031GB, peak=7.583GB, intermediate=0.250GB, init=6.112GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 7, 1]=0.285, max_n_succ_stage=205, Mem: avail=28.031GB, peak=13.567GB, intermediate=0.047GB, init=4.795GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 7, 4]=0.431, max_n_succ_stage=88, Mem: avail=28.031GB, peak=6.471GB, intermediate=0.188GB, init=4.798GB, as_config=((8, 1), {})
cost[3, 7, 1]=0.368, max_n_succ_stage=84, Mem: avail=28.031GB, peak=16.600GB, intermediate=0.062GB, init=6.108GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 7, 3]=0.431, max_n_succ_stage=88, Mem: avail=28.031GB, peak=6.471GB, intermediate=0.188GB, init=4.798GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 7, 2]=0.431, max_n_succ_stage=107, Mem: avail=28.031GB, peak=8.325GB, intermediate=0.125GB, init=6.109GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 7, 4]=0.557, max_n_succ_stage=56, Mem: avail=28.031GB, peak=7.583GB, intermediate=0.250GB, init=6.112GB, as_config=((8, 1), {})
Profiling for submesh 3 (1, 8) takes 361.54 seconds
Profiled costs are: [[[       inf        inf        inf        inf        inf]
  [0.13346734 0.147734   0.17364646 0.22533849 0.22519563]
  [0.19961427 0.2211927  0.26029853 0.33862076 0.33847791]
  [0.27478708 0.30426931 0.35765938 0.46515497 0.46515497]
  [0.33965317 0.37613387 0.44216326 0.57517742 0.57517742]
  [0.40580011 0.44959258 0.52881523 0.6884597  0.6884597 ]
  [0.47194704 0.52305128 0.6154672  0.80174198 0.80174198]
  [0.53292699 0.58912132 0.69076948 0.89603841 0.89603841]]

 [[       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [0.2074678  0.22994756 0.27079775 0.35265736 0.35265736]
  [0.27233389 0.30181212 0.35530162 0.46267982 0.46267982]
  [0.33848083 0.37527082 0.44195359 0.57596209 0.57596209]
  [0.40462776 0.44872952 0.52860556 0.68924437 0.68924437]
  [0.46560771 0.51482355 0.60384219 0.78359744 0.78359744]]

 [[       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [0.14132087 0.15648886 0.18414569 0.23937508 0.23937508]
  [0.20618697 0.22835342 0.26864965 0.34939754 0.34939754]
  [0.2723339  0.30181212 0.35530162 0.46267982 0.46267982]
  [0.33848083 0.37527082 0.44195359 0.57596209 0.57596209]
  [0.39946079 0.44136485 0.51719022 0.67031517 0.67031517]]

 [[       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [0.14004004 0.15489472 0.18199759 0.23611526 0.23611526]
  [0.20618697 0.22835342 0.26864965 0.34939754 0.34939754]
  [0.2723339  0.30181212 0.35530162 0.46267982 0.46267982]
  [0.33331386 0.36790615 0.43053825 0.55703289 0.55703289]]

 [[       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [0.19716108 0.2187595  0.25787512 0.33653036 0.33653036]
  [0.25814104 0.28482954 0.3331774  0.43082679 0.43082679]]

 [[       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [0.19327495 0.21296498 0.24867352 0.32080433 0.32080433]]

 [[       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]]]
Profiled max_n_succ_stages are: [[[  -1   -1   -1   -1   -1]
  [1640 1226  691  327  327]
  [ 361  480  307  144  144]
  [  -1  216  175   84   84]
  [  -1   95  110   50   50]
  [  -1   22   71   34   34]
  [  -1   -1   45   22   22]
  [  -1   -1   15   18   18]]

 [[  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [ 324  469  304  144  144]
  [  -1  223  177   82   82]
  [  -1  100  111   53   53]
  [  -1   26   72   38   38]
  [  -1   -1   34   27   27]]

 [[  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [1575 1202  685  326  326]
  [ 328  469  304  142  142]
  [  -1  223  177   81   81]
  [  -1  100  111   51   51]
  [  -1   13   59   35   35]]

 [[  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [1579 1202  682  326  326]
  [ 328  469  303  142  142]
  [  -1  223  177   85   85]
  [  -1   84  107   56   56]]

 [[  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [ 404  492  310  150  150]
  [  -1  205  176   88   88]]

 [[  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [ 286  442  301  144  144]]

 [[  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]]]
--------------------------------------------------
- Profiling for submesh 2 (1, 4):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
cost[3, 3, 2]=0.184, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=5.267GB, intermediate=0.000GB, init=2.627GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 0, 1]=0.141, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=4.839GB, intermediate=0.000GB, init=2.468GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 0, 0]=0.127, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=6.611GB, intermediate=0.000GB, init=2.467GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 3, 0]=0.140, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=7.142GB, intermediate=0.000GB, init=2.626GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 4, 1]=0.291, max_n_succ_stage=503, Mem: avail=28.031GB, peak=7.393GB, intermediate=0.031GB, init=4.877GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 3, 1]=0.156, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=4.862GB, intermediate=0.000GB, init=2.626GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 3, 2]=0.348, max_n_succ_stage=246, Mem: avail=28.031GB, peak=7.664GB, intermediate=0.062GB, init=4.878GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 0, 2]=0.165, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=4.922GB, intermediate=0.000GB, init=2.468GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 0, 3]=0.165, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=4.922GB, intermediate=0.000GB, init=2.468GB, as_config=((4, 1), {})
cost[3, 3, 3]=0.184, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=5.267GB, intermediate=0.000GB, init=2.627GB, as_config=((4, 1), {})
cost[1, 2, 0]=0.247, max_n_succ_stage=668, Mem: avail=28.031GB, peak=13.066GB, intermediate=0.016GB, init=4.501GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 3, 3]=0.348, max_n_succ_stage=246, Mem: avail=28.031GB, peak=7.664GB, intermediate=0.062GB, init=4.878GB, as_config=((4, 1), {})
cost[4, 5, 3]=0.324, max_n_succ_stage=254, Mem: avail=28.031GB, peak=7.533GB, intermediate=0.062GB, init=4.503GB, as_config=((4, 1), {})
cost[1, 2, 1]=0.276, max_n_succ_stage=531, Mem: avail=28.031GB, peak=6.893GB, intermediate=0.031GB, init=4.502GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 4, 3]=0.344, max_n_succ_stage=246, Mem: avail=28.031GB, peak=7.677GB, intermediate=0.062GB, init=4.878GB, as_config=((4, 1), {})
cost[0, 1, 2]=0.329, max_n_succ_stage=249, Mem: avail=28.031GB, peak=7.663GB, intermediate=0.062GB, init=4.720GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 3, 1]=0.294, max_n_succ_stage=507, Mem: avail=28.031GB, peak=7.268GB, intermediate=0.031GB, init=4.877GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 4, 2]=0.344, max_n_succ_stage=246, Mem: avail=28.031GB, peak=7.677GB, intermediate=0.062GB, init=4.878GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 1, 0]=0.251, max_n_succ_stage=619, Mem: avail=28.031GB, peak=13.613GB, intermediate=0.016GB, init=4.718GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 5, 2]=0.324, max_n_succ_stage=254, Mem: avail=28.031GB, peak=7.533GB, intermediate=0.062GB, init=4.503GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 1, 1]=0.279, max_n_succ_stage=515, Mem: avail=28.031GB, peak=7.176GB, intermediate=0.031GB, init=4.718GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 5, 1]=0.273, max_n_succ_stage=529, Mem: avail=28.031GB, peak=6.956GB, intermediate=0.031GB, init=4.502GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 2, 3]=0.327, max_n_succ_stage=254, Mem: avail=28.031GB, peak=7.539GB, intermediate=0.062GB, init=4.503GB, as_config=((4, 1), {})
cost[2, 4, 3]=0.508, max_n_succ_stage=88, Mem: avail=28.031GB, peak=9.776GB, intermediate=0.125GB, init=7.129GB, as_config=((4, 1), {})
cost[4, 5, 0]=0.245, max_n_succ_stage=668, Mem: avail=28.031GB, peak=13.066GB, intermediate=0.016GB, init=4.501GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 4, 0]=0.262, max_n_succ_stage=641, Mem: avail=28.031GB, peak=13.113GB, intermediate=0.016GB, init=4.876GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 2, 2]=0.327, max_n_succ_stage=252, Mem: avail=28.031GB, peak=7.667GB, intermediate=0.062GB, init=4.503GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 1, 3]=0.329, max_n_succ_stage=249, Mem: avail=28.031GB, peak=7.685GB, intermediate=0.062GB, init=4.720GB, as_config=((4, 1), {})
cost[2, 3, 0]=0.264, max_n_succ_stage=641, Mem: avail=28.031GB, peak=13.113GB, intermediate=0.016GB, init=4.876GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 5, 1]=0.429, max_n_succ_stage=174, Mem: avail=28.031GB, peak=9.926GB, intermediate=0.062GB, init=7.128GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 6, 1]=0.276, max_n_succ_stage=528, Mem: avail=28.031GB, peak=6.988GB, intermediate=0.031GB, init=4.502GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 6, 2]=0.328, max_n_succ_stage=251, Mem: avail=28.031GB, peak=7.721GB, intermediate=0.062GB, init=4.503GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 6, 3]=0.488, max_n_succ_stage=101, Mem: avail=28.031GB, peak=8.483GB, intermediate=0.125GB, init=6.754GB, as_config=((4, 1), {})
cost[5, 6, 0]=0.247, max_n_succ_stage=668, Mem: avail=28.031GB, peak=13.066GB, intermediate=0.016GB, init=4.501GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 2, 0]=0.374, max_n_succ_stage=45, Mem: avail=28.031GB, peak=19.614GB, intermediate=0.031GB, init=6.969GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 6, 3]=0.328, max_n_succ_stage=251, Mem: avail=28.031GB, peak=7.721GB, intermediate=0.062GB, init=4.503GB, as_config=((4, 1), {})
cost[1, 3, 2]=0.513, max_n_succ_stage=87, Mem: avail=28.031GB, peak=9.882GB, intermediate=0.125GB, init=7.129GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 3, 1]=0.432, max_n_succ_stage=175, Mem: avail=28.031GB, peak=9.863GB, intermediate=0.062GB, init=7.128GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 4, 1]=0.429, max_n_succ_stage=175, Mem: avail=28.031GB, peak=9.863GB, intermediate=0.062GB, init=7.128GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 6, 1]=0.411, max_n_succ_stage=188, Mem: avail=28.031GB, peak=9.457GB, intermediate=0.062GB, init=6.753GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 4, 0]=0.385, max_n_succ_stage=25, Mem: avail=28.031GB, peak=20.068GB, intermediate=0.031GB, init=7.127GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[6, 7, 0]=0.239, max_n_succ_stage=531, Mem: avail=28.031GB, peak=14.629GB, intermediate=0.016GB, init=5.087GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 5, 3]=0.508, max_n_succ_stage=86, Mem: avail=28.031GB, peak=9.963GB, intermediate=0.125GB, init=7.129GB, as_config=((4, 1), {})
cost[3, 5, 0]=0.385, max_n_succ_stage=25, Mem: avail=28.031GB, peak=20.068GB, intermediate=0.031GB, init=7.127GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 3, 3]=0.513, max_n_succ_stage=87, Mem: avail=28.031GB, peak=9.882GB, intermediate=0.125GB, init=7.129GB, as_config=((4, 1), {})
cost[1, 3, 0]=0.388, max_n_succ_stage=25, Mem: avail=28.031GB, peak=20.068GB, intermediate=0.031GB, init=7.127GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 4, 2]=0.508, max_n_succ_stage=88, Mem: avail=28.031GB, peak=9.776GB, intermediate=0.125GB, init=7.129GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[6, 7, 3]=0.308, max_n_succ_stage=250, Mem: avail=28.031GB, peak=7.207GB, intermediate=0.062GB, init=5.089GB, as_config=((4, 1), {})
cost[0, 2, 3]=0.493, max_n_succ_stage=90, Mem: avail=28.031GB, peak=9.587GB, intermediate=0.125GB, init=6.971GB, as_config=((4, 1), {})
cost[6, 7, 2]=0.308, max_n_succ_stage=250, Mem: avail=28.031GB, peak=7.207GB, intermediate=0.062GB, init=5.089GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 6, 2]=0.488, max_n_succ_stage=101, Mem: avail=28.031GB, peak=8.483GB, intermediate=0.125GB, init=6.754GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 5, 2]=0.508, max_n_succ_stage=86, Mem: avail=28.031GB, peak=9.963GB, intermediate=0.125GB, init=7.129GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 6, 0]=0.369, max_n_succ_stage=69, Mem: avail=28.031GB, peak=19.067GB, intermediate=0.031GB, init=6.752GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 2, 2]=0.493, max_n_succ_stage=90, Mem: avail=28.031GB, peak=9.595GB, intermediate=0.125GB, init=6.971GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 2, 1]=0.417, max_n_succ_stage=181, Mem: avail=28.031GB, peak=9.646GB, intermediate=0.062GB, init=6.969GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[6, 7, 1]=0.263, max_n_succ_stage=497, Mem: avail=28.031GB, peak=7.362GB, intermediate=0.031GB, init=5.088GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 7, 0]=0.362, max_n_succ_stage=1, Mem: avail=28.031GB, peak=20.630GB, intermediate=0.031GB, init=7.338GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 7, 0]=0.484, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=26.632GB, intermediate=0.047GB, init=9.588GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 7, 1]=0.536, max_n_succ_stage=37, Mem: avail=28.031GB, peak=14.810GB, intermediate=0.094GB, init=9.590GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 7, 3]=0.472, max_n_succ_stage=95, Mem: avail=28.031GB, peak=8.584GB, intermediate=0.125GB, init=7.340GB, as_config=((4, 1), {})
cost[5, 7, 2]=0.472, max_n_succ_stage=95, Mem: avail=28.031GB, peak=8.584GB, intermediate=0.125GB, init=7.340GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 7, 3]=0.632, max_n_succ_stage=42, Mem: avail=28.031GB, peak=10.211GB, intermediate=0.188GB, init=9.592GB, as_config=((4, 1), {})
cost[5, 7, 1]=0.401, max_n_succ_stage=169, Mem: avail=28.031GB, peak=10.020GB, intermediate=0.062GB, init=7.339GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 7, 2]=0.632, max_n_succ_stage=42, Mem: avail=28.031GB, peak=10.211GB, intermediate=0.188GB, init=9.592GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
Profiling for submesh 2 (1, 4) takes 173.09 seconds
Profiled costs are: [[[0.12713713 0.14082603 0.16490586 0.16483254        inf]
  [0.25079022 0.27883281 0.32907466 0.32900134        inf]
  [0.37444331 0.41684001 0.49324345 0.49317013        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [0.24730718 0.27593612 0.32728233 0.32720901        inf]
  [0.38768807 0.43185031 0.51250575 0.51250575        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [0.26403498 0.29384311 0.34833695 0.34833695        inf]
  [0.38530566 0.42886132 0.50842245 0.50842245        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [0.1403819  0.1558362  0.18416816 0.18416816        inf]
  [0.26165258 0.29085412 0.34425365 0.34425365        inf]
  [0.38530567 0.42886132 0.50842245 0.50842245        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [0.24492478 0.272987   0.32421465 0.32421465        inf]
  [0.36857786 0.41099421 0.48838345 0.48838345        inf]
  [0.48368202 0.53623927 0.63210267 0.63210267        inf]]

 [[       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [0.24730718 0.27597599 0.32829796 0.32829796        inf]
  [0.36241133 0.40122106 0.47201717 0.47201717        inf]]

 [[       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [0.23875824 0.26320552 0.30784838 0.30784838        inf]]

 [[       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]]]
Profiled max_n_succ_stages are: [[[4096 4096 4096 4096   -1]
  [ 619  515  249  249   -1]
  [  45  181   90   90   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [ 668  531  252  254   -1]
  [  25  175   87   87   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [ 641  507  246  246   -1]
  [  25  175   88   88   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [4096 4096 4096 4096   -1]
  [ 641  503  246  246   -1]
  [  25  174   86   86   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [ 668  529  254  254   -1]
  [  69  188  101  101   -1]
  [  -1   37   42   42   -1]]

 [[  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [ 668  528  251  251   -1]
  [   1  169   95   95   -1]]

 [[  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [ 531  497  250  250   -1]]

 [[  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]]]
--------------------------------------------------
- Profiling for submesh 1 (1, 2):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
cost[3, 3, 0]=0.276, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=8.317GB, intermediate=0.000GB, init=5.251GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[7, 7, 2]=0.246, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=8.495GB, intermediate=0.000GB, init=5.674GB, as_config=((2, 1), {})
cost[7, 7, 0]=0.226, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=9.161GB, intermediate=0.000GB, init=5.673GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[6, 7, 1]=0.516, max_n_succ_stage=94, Mem: avail=28.031GB, peak=11.892GB, intermediate=0.062GB, init=10.176GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[7, 7, 1]=0.246, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=8.495GB, intermediate=0.000GB, init=5.674GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 2, 1]=0.270, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=7.408GB, intermediate=0.000GB, init=4.502GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 5, 0]=0.480, max_n_succ_stage=215, Mem: avail=28.031GB, peak=12.254GB, intermediate=0.031GB, init=9.002GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 1, 2]=0.270, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=7.408GB, intermediate=0.000GB, init=4.502GB, as_config=((2, 1), {})
cost[0, 0, 0]=0.249, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=7.814GB, intermediate=0.000GB, init=4.935GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 1, 0]=0.242, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=7.411GB, intermediate=0.000GB, init=4.501GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 0, 1]=0.275, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=7.610GB, intermediate=0.000GB, init=4.935GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 5, 0]=0.242, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=7.661GB, intermediate=0.000GB, init=4.501GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[6, 6, 0]=0.242, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=7.629GB, intermediate=0.000GB, init=4.501GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 5, 2]=0.270, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=7.628GB, intermediate=0.000GB, init=4.502GB, as_config=((2, 1), {})
cost[4, 4, 2]=0.264, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=7.347GB, intermediate=0.000GB, init=4.502GB, as_config=((2, 1), {})
cost[3, 3, 1]=0.306, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=8.003GB, intermediate=0.000GB, init=5.252GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 2, 2]=0.270, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=7.408GB, intermediate=0.000GB, init=4.502GB, as_config=((2, 1), {})
cost[4, 4, 0]=0.238, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=7.536GB, intermediate=0.000GB, init=4.501GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 5, 1]=0.270, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=7.628GB, intermediate=0.000GB, init=4.502GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 1, 1]=0.270, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=7.408GB, intermediate=0.000GB, init=4.502GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 0, 2]=0.275, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=7.610GB, intermediate=0.000GB, init=4.935GB, as_config=((2, 1), {})
cost[3, 3, 2]=0.306, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=8.003GB, intermediate=0.000GB, init=5.252GB, as_config=((2, 1), {})
cost[6, 6, 1]=0.270, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=7.440GB, intermediate=0.000GB, init=4.502GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 2, 0]=0.242, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=7.411GB, intermediate=0.000GB, init=4.501GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[6, 6, 2]=0.270, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=7.440GB, intermediate=0.000GB, init=4.502GB, as_config=((2, 1), {})
cost[4, 4, 1]=0.264, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=7.347GB, intermediate=0.000GB, init=4.502GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[6, 7, 0]=0.469, max_n_succ_stage=123, Mem: avail=28.031GB, peak=13.972GB, intermediate=0.031GB, init=10.175GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 2, 0]=0.485, max_n_succ_stage=206, Mem: avail=28.031GB, peak=12.534GB, intermediate=0.031GB, init=9.002GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 2, 1]=0.540, max_n_succ_stage=101, Mem: avail=28.031GB, peak=12.597GB, intermediate=0.062GB, init=9.003GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 6, 0]=0.485, max_n_succ_stage=211, Mem: avail=28.031GB, peak=12.379GB, intermediate=0.031GB, init=9.002GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 2, 2]=0.540, max_n_succ_stage=101, Mem: avail=28.031GB, peak=12.597GB, intermediate=0.062GB, init=9.003GB, as_config=((2, 1), {})
cost[4, 5, 2]=0.534, max_n_succ_stage=101, Mem: avail=28.031GB, peak=12.598GB, intermediate=0.062GB, init=9.004GB, as_config=((2, 1), {})
cost[6, 7, 2]=0.516, max_n_succ_stage=94, Mem: avail=28.031GB, peak=11.892GB, intermediate=0.062GB, init=10.176GB, as_config=((2, 1), {})
cost[5, 6, 2]=0.540, max_n_succ_stage=98, Mem: avail=28.031GB, peak=12.784GB, intermediate=0.062GB, init=9.004GB, as_config=((2, 1), {})
cost[4, 5, 1]=0.534, max_n_succ_stage=101, Mem: avail=28.031GB, peak=12.598GB, intermediate=0.062GB, init=9.004GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 6, 1]=0.540, max_n_succ_stage=98, Mem: avail=28.031GB, peak=12.784GB, intermediate=0.062GB, init=9.004GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
Profiling for submesh 1 (1, 2) takes 71.62 seconds
Profiled costs are: [[[0.24939469 0.27544283 0.27544694        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf]
  [0.24239467 0.26958798 0.26958798        inf        inf]
  [0.48478827 0.53973754 0.53974165        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [0.24239467 0.26958798 0.26958798        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [0.27577854 0.30574627 0.30574627        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [0.23763041 0.26418043 0.26418043        inf        inf]
  [0.48002401 0.5343341  0.5343341         inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [0.24239467 0.27010987 0.27010987        inf        inf]
  [0.48478827 0.54026354 0.54026354        inf        inf]
  [       inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [0.24239467 0.27006608 0.27006608        inf        inf]
  [0.46877091 0.51612391 0.51612391        inf        inf]]

 [[       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [0.22637731 0.24597025 0.24597025        inf        inf]]]
Profiled max_n_succ_stages are: [[[4096 4096 4096   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1]
  [4096 4096 4096   -1   -1]
  [ 206  101  101   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [4096 4096 4096   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [4096 4096 4096   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [4096 4096 4096   -1   -1]
  [ 215  101  101   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [4096 4096 4096   -1   -1]
  [ 211   98   98   -1   -1]
  [  -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [4096 4096 4096   -1   -1]
  [ 123   94   94   -1   -1]]

 [[  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [4096 4096 4096   -1   -1]]]
--------------------------------------------------
- Profiling for submesh 0 (1, 1):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
cost[7, 7, 0]=0.446, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=14.489GB, intermediate=0.000GB, init=11.347GB, as_config=((1, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[7, 7, 1]=0.446, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=14.489GB, intermediate=0.000GB, init=11.347GB, as_config=((1, 1), {})
cost[1, 1, 1]=0.477, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=12.066GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {})
cost[6, 6, 0]=0.477, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=12.441GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 2, 0]=0.477, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=12.066GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 1, 0]=0.477, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=12.066GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[6, 6, 1]=0.477, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=12.441GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {})
cost[2, 2, 1]=0.477, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=12.066GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {})
cost[4, 4, 0]=0.467, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=12.130GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 4, 1]=0.467, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=12.130GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {})
cost[5, 5, 0]=0.477, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=12.505GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 5, 1]=0.477, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=12.505GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {})
Profiling for submesh 0 (1, 1) takes 26.70 seconds
Profiled costs are: [[[       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf]
  [0.47657693 0.47657693        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [0.47657693 0.47657693        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [0.46709613 0.46709613        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [0.47657693 0.47657693        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [0.47657693 0.47657693        inf        inf        inf]
  [       inf        inf        inf        inf        inf]]

 [[       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [       inf        inf        inf        inf        inf]
  [0.44642974 0.44642974        inf        inf        inf]]]
Profiled max_n_succ_stages are: [[[  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1]
  [4096 4096   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [4096 4096   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [4096 4096   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [4096 4096   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [4096 4096   -1   -1   -1]
  [  -1   -1   -1   -1   -1]]

 [[  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [  -1   -1   -1   -1   -1]
  [4096 4096   -1   -1   -1]]]
--------------------------------------------------
Compute cost saved to: compute-cost-2022-11-12-03-41-42.npy
----------------------------------------------------------------------
Result forward_stage_layer_ids: [[0, 1], [2], [3, 4], [5, 6], [7]]
Result mesh_shapes: [(1, 4), (1, 2), (1, 4), (1, 4), (1, 2)]
Result logical_mesh_shapes: [(4, 1), (2, 1), (4, 1), (4, 1), (2, 1)]
Result autosharding_option_dicts: [{'force_batch_dim_to_mesh_dim': 0}, {'force_batch_dim_to_mesh_dim': 0}, {'force_batch_dim_to_mesh_dim': 0}, {'force_batch_dim_to_mesh_dim': 0}, {'force_batch_dim_to_mesh_dim': 0}]
 - Compile (driver): 826.53 s
compilation time breakdown: {'stage-construction': '743.27', 'stage-construction-dp': '1.81', 'stage-construction-compilation': '515.50', 'stage-construction-profiling': '222.17'}
 - Compile (worker): 32.65 s
Iteration 0 ...
Iteration 1 ...
Iteration 2 ...
 - Benchmark: 246.89 s
Type: gpt  Model Config: GPTModelConfig(seq_len=1024, hidden_size=4096, num_layers=32, num_heads=32, vocab_size=51200)  #Microbatch: 128  #GPU: 16  Parallel Config: SearchParallelArgs(prefer_reduce_scatter=True, use_remat=True, num_auto_layers=8, auto_stage_option={'submesh_physical_shape_space': 'small_power_of_two', 'submesh_logical_shape_space': 'all', 'stage_imbalance_tolerance': 1.0, 'use_hlo_cost_model': True, 'profiling_database_filename': 'prof_database.pkl'})  Mean Time (s): 72.279  Std Time (s): 0.085  #Params (Billion): 6.654B  TFLOPs: 49.82  Peak Mem (GB): 14.770  Metadata: {'compilation_times': "{'stage-construction': '743.27', 'stage-construction-dp': '1.81', 'stage-construction-compilation': '515.50', 'stage-construction-profiling': '222.17'}", 'compute_cost_file_name': 'compute-cost-2022-11-12-03-41-42.npy', 'forward_stage_layer_ids': '[[0, 1], [2], [3, 4], [5, 6], [7]]', 'submesh_shapes': '[[1, 4], [1, 2], [1, 4], [1, 4], [1, 2]]', 'logical_mesh_shapes': '[[4, 1], [2, 1], [4, 1], [4, 1], [2, 1]]', 'autosharding_option_dicts': "[{'force_batch_dim_to_mesh_dim': '0'}, {'force_batch_dim_to_mesh_dim': '0'}, {'force_batch_dim_to_mesh_dim': '0'}, {'force_batch_dim_to_mesh_dim': '0'}, {'force_batch_dim_to_mesh_dim': '0'}]"}  
Working on case: BenchmarkCase(batch_size=1024, model_config=GPTModelConfig(seq_len=1024, hidden_size=4096, num_layers=32, num_heads=32, vocab_size=51200), num_micro_batches=256, parallel_mode='search', parallel_args=SearchParallelArgs(prefer_reduce_scatter=True, use_remat=True, num_auto_layers=8, auto_stage_option={'submesh_physical_shape_space': 'small_power_of_two', 'submesh_logical_shape_space': 'all', 'stage_imbalance_tolerance': 1.0, 'use_hlo_cost_model': True, 'profiling_database_filename': 'prof_database.pkl'}))
 - Prepare input: 0.05 s
 - Create train state: 6.62 s
-------------------- Automatic stage clustering --------------------
submesh_choices: ((1, 1), (1, 2), (1, 4), (1, 8), (1, 16))
- Profiling for submesh 4 (1, 16):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
cost[0, 7, 0]=0.202, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=13.043GB, intermediate=0.000GB, init=4.797GB, as_config=((4, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 7, 3]=0.361, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=5.579GB, intermediate=0.000GB, init=4.804GB, as_config=((16, 1), {})
cost[0, 7, 2]=0.361, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=5.579GB, intermediate=0.000GB, init=4.804GB, as_config=((1, 16), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 7, 1]=0.254, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=6.884GB, intermediate=0.000GB, init=4.800GB, as_config=((2, 8), {'force_batch_dim_to_mesh_dim': 0})
Profiling for submesh 4 (1, 16) takes 97.97 seconds
Profiled costs are: [[[       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [0.20173191 0.2540176  0.36082342 0.36082342]]

 [[       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]]

 [[       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]]

 [[       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]]

 [[       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]]

 [[       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]]

 [[       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]]

 [[       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]]]
Profiled max_n_succ_stages are: [[[  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [4096 4096 4096 4096]]

 [[  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]]

 [[  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]]

 [[  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]]

 [[  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]]

 [[  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]]

 [[  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]]

 [[  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]]]
--------------------------------------------------
- Profiling for submesh 3 (1, 8):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
cost[0, 1, 3]=0.130, max_n_succ_stage=716, Mem: avail=28.031GB, peak=3.250GB, intermediate=0.031GB, init=2.361GB, as_config=((8, 1), {})
cost[1, 3, 2]=0.190, max_n_succ_stage=325, Mem: avail=28.031GB, peak=4.058GB, intermediate=0.062GB, init=3.566GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 1, 2]=0.122, max_n_succ_stage=717, Mem: avail=28.031GB, peak=3.231GB, intermediate=0.031GB, init=2.361GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 1, 0]=0.080, max_n_succ_stage=2460, Mem: avail=28.031GB, peak=6.440GB, intermediate=0.008GB, init=2.359GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 1, 1]=0.097, max_n_succ_stage=1434, Mem: avail=28.031GB, peak=3.240GB, intermediate=0.016GB, init=2.360GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 2, 1]=0.146, max_n_succ_stage=620, Mem: avail=28.031GB, peak=5.128GB, intermediate=0.031GB, init=3.485GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 3, 3]=0.190, max_n_succ_stage=325, Mem: avail=28.031GB, peak=4.058GB, intermediate=0.062GB, init=3.566GB, as_config=((8, 1), {})
cost[1, 3, 0]=0.124, max_n_succ_stage=943, Mem: avail=28.031GB, peak=9.715GB, intermediate=0.016GB, init=3.564GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 2, 3]=0.191, max_n_succ_stage=325, Mem: avail=28.031GB, peak=4.118GB, intermediate=0.062GB, init=3.487GB, as_config=((8, 1), {})
cost[1, 4, 0]=0.163, max_n_succ_stage=450, Mem: avail=28.031GB, peak=12.763GB, intermediate=0.023GB, init=4.689GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 2, 2]=0.183, max_n_succ_stage=325, Mem: avail=28.031GB, peak=4.122GB, intermediate=0.062GB, init=3.487GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 2, 0]=0.120, max_n_succ_stage=964, Mem: avail=28.031GB, peak=9.464GB, intermediate=0.016GB, init=3.485GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 3, 0]=0.084, max_n_succ_stage=2418, Mem: avail=28.031GB, peak=6.690GB, intermediate=0.008GB, init=2.438GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 3, 1]=0.152, max_n_succ_stage=614, Mem: avail=28.031GB, peak=5.233GB, intermediate=0.031GB, init=3.565GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 3, 1]=0.103, max_n_succ_stage=1403, Mem: avail=28.031GB, peak=3.646GB, intermediate=0.016GB, init=2.439GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 3, 3]=0.129, max_n_succ_stage=706, Mem: avail=28.031GB, peak=3.467GB, intermediate=0.031GB, init=2.440GB, as_config=((8, 1), {})
cost[2, 3, 2]=0.129, max_n_succ_stage=706, Mem: avail=28.031GB, peak=3.467GB, intermediate=0.031GB, init=2.440GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 4, 3]=0.249, max_n_succ_stage=192, Mem: avail=28.031GB, peak=5.152GB, intermediate=0.094GB, init=4.693GB, as_config=((8, 1), {})
cost[0, 3, 0]=0.164, max_n_succ_stage=435, Mem: avail=28.031GB, peak=13.012GB, intermediate=0.023GB, init=4.798GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 4, 2]=0.249, max_n_succ_stage=192, Mem: avail=28.031GB, peak=5.152GB, intermediate=0.094GB, init=4.693GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 3, 3]=0.250, max_n_succ_stage=192, Mem: avail=28.031GB, peak=5.045GB, intermediate=0.094GB, init=4.801GB, as_config=((8, 1), {})
cost[0, 3, 1]=0.201, max_n_succ_stage=346, Mem: avail=28.031GB, peak=6.965GB, intermediate=0.047GB, init=4.799GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 3, 2]=0.250, max_n_succ_stage=192, Mem: avail=28.031GB, peak=5.045GB, intermediate=0.094GB, init=4.801GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 4, 1]=0.199, max_n_succ_stage=350, Mem: avail=28.031GB, peak=6.867GB, intermediate=0.047GB, init=4.690GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 4, 0]=0.123, max_n_succ_stage=944, Mem: avail=28.031GB, peak=9.699GB, intermediate=0.016GB, init=3.564GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 5, 3]=0.310, max_n_succ_stage=129, Mem: avail=28.031GB, peak=5.840GB, intermediate=0.125GB, init=5.819GB, as_config=((8, 1), {})
cost[2, 4, 1]=0.150, max_n_succ_stage=613, Mem: avail=28.031GB, peak=5.249GB, intermediate=0.031GB, init=3.565GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 4, 2]=0.310, max_n_succ_stage=125, Mem: avail=28.031GB, peak=6.256GB, intermediate=0.125GB, init=5.927GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 4, 2]=0.188, max_n_succ_stage=322, Mem: avail=28.031GB, peak=4.272GB, intermediate=0.062GB, init=3.566GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 4, 3]=0.310, max_n_succ_stage=125, Mem: avail=28.031GB, peak=6.256GB, intermediate=0.125GB, init=5.927GB, as_config=((8, 1), {})
cost[0, 4, 1]=0.248, max_n_succ_stage=215, Mem: avail=28.031GB, peak=8.576GB, intermediate=0.062GB, init=5.924GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 4, 3]=0.188, max_n_succ_stage=322, Mem: avail=28.031GB, peak=4.272GB, intermediate=0.062GB, init=3.566GB, as_config=((8, 1), {})
cost[3, 4, 2]=0.127, max_n_succ_stage=708, Mem: avail=28.031GB, peak=3.424GB, intermediate=0.031GB, init=2.440GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 5, 1]=0.248, max_n_succ_stage=218, Mem: avail=28.031GB, peak=8.513GB, intermediate=0.062GB, init=5.816GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 4, 0]=0.084, max_n_succ_stage=2420, Mem: avail=28.031GB, peak=6.674GB, intermediate=0.008GB, init=2.438GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 4, 0]=0.203, max_n_succ_stage=193, Mem: avail=28.031GB, peak=16.045GB, intermediate=0.031GB, init=5.923GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 5, 0]=0.203, max_n_succ_stage=204, Mem: avail=28.031GB, peak=15.795GB, intermediate=0.031GB, init=5.815GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 6, 3]=0.371, max_n_succ_stage=90, Mem: avail=28.031GB, peak=6.751GB, intermediate=0.156GB, init=6.945GB, as_config=((8, 1), {})
cost[3, 4, 1]=0.102, max_n_succ_stage=1418, Mem: avail=28.031GB, peak=3.408GB, intermediate=0.016GB, init=2.439GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 5, 2]=0.310, max_n_succ_stage=129, Mem: avail=28.031GB, peak=5.840GB, intermediate=0.125GB, init=5.819GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 5, 0]=0.163, max_n_succ_stage=451, Mem: avail=28.031GB, peak=12.747GB, intermediate=0.023GB, init=4.689GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 5, 3]=0.371, max_n_succ_stage=90, Mem: avail=28.031GB, peak=6.637GB, intermediate=0.156GB, init=7.054GB, as_config=((8, 1), {})
cost[3, 4, 3]=0.127, max_n_succ_stage=708, Mem: avail=28.031GB, peak=3.424GB, intermediate=0.031GB, init=2.440GB, as_config=((8, 1), {})
cost[2, 5, 3]=0.249, max_n_succ_stage=191, Mem: avail=28.031GB, peak=5.308GB, intermediate=0.094GB, init=4.693GB, as_config=((8, 1), {})
cost[1, 6, 2]=0.371, max_n_succ_stage=90, Mem: avail=28.031GB, peak=6.751GB, intermediate=0.156GB, init=6.945GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 5, 1]=0.199, max_n_succ_stage=349, Mem: avail=28.031GB, peak=6.898GB, intermediate=0.047GB, init=4.690GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 5, 2]=0.249, max_n_succ_stage=191, Mem: avail=28.031GB, peak=5.308GB, intermediate=0.094GB, init=4.693GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 6, 1]=0.297, max_n_succ_stage=139, Mem: avail=28.031GB, peak=10.127GB, intermediate=0.078GB, init=6.942GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 6, 0]=0.243, max_n_succ_stage=56, Mem: avail=28.031GB, peak=18.827GB, intermediate=0.039GB, init=6.940GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 5, 0]=0.243, max_n_succ_stage=46, Mem: avail=28.031GB, peak=19.109GB, intermediate=0.039GB, init=7.049GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 5, 2]=0.371, max_n_succ_stage=90, Mem: avail=28.031GB, peak=6.637GB, intermediate=0.156GB, init=7.054GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 5, 3]=0.188, max_n_succ_stage=322, Mem: avail=28.031GB, peak=4.241GB, intermediate=0.062GB, init=3.566GB, as_config=((8, 1), {})
cost[3, 5, 0]=0.123, max_n_succ_stage=944, Mem: avail=28.031GB, peak=9.699GB, intermediate=0.016GB, init=3.564GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 5, 2]=0.188, max_n_succ_stage=322, Mem: avail=28.031GB, peak=4.241GB, intermediate=0.062GB, init=3.566GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 5, 1]=0.150, max_n_succ_stage=612, Mem: avail=28.031GB, peak=5.296GB, intermediate=0.031GB, init=3.565GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 7, 1]=0.339, max_n_succ_stage=84, Mem: avail=28.031GB, peak=11.679GB, intermediate=0.094GB, init=8.361GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 6, 3]=0.181, max_n_succ_stage=327, Mem: avail=28.031GB, peak=4.140GB, intermediate=0.062GB, init=3.379GB, as_config=((8, 1), {})
cost[0, 6, 3]=0.432, max_n_succ_stage=63, Mem: avail=28.031GB, peak=7.767GB, intermediate=0.188GB, init=8.180GB, as_config=((8, 1), {})
cost[0, 5, 1]=0.297, max_n_succ_stage=136, Mem: avail=28.031GB, peak=10.221GB, intermediate=0.078GB, init=7.050GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 6, 0]=0.118, max_n_succ_stage=989, Mem: avail=28.031GB, peak=9.175GB, intermediate=0.016GB, init=3.376GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 6, 2]=0.310, max_n_succ_stage=127, Mem: avail=28.031GB, peak=6.110GB, intermediate=0.125GB, init=5.819GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 6, 0]=0.203, max_n_succ_stage=204, Mem: avail=28.031GB, peak=15.795GB, intermediate=0.031GB, init=5.815GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 6, 0]=0.163, max_n_succ_stage=451, Mem: avail=28.031GB, peak=12.747GB, intermediate=0.023GB, init=4.689GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 6, 2]=0.432, max_n_succ_stage=63, Mem: avail=28.031GB, peak=7.767GB, intermediate=0.188GB, init=8.180GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 6, 1]=0.248, max_n_succ_stage=218, Mem: avail=28.031GB, peak=8.513GB, intermediate=0.062GB, init=5.816GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 7, 3]=0.422, max_n_succ_stage=64, Mem: avail=28.031GB, peak=7.465GB, intermediate=0.188GB, init=8.365GB, as_config=((8, 1), {})
cost[5, 7, 0]=0.115, max_n_succ_stage=918, Mem: avail=28.031GB, peak=9.988GB, intermediate=0.016GB, init=3.669GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 7, 2]=0.422, max_n_succ_stage=64, Mem: avail=28.031GB, peak=7.465GB, intermediate=0.188GB, init=8.365GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 7, 3]=0.361, max_n_succ_stage=90, Mem: avail=28.031GB, peak=6.558GB, intermediate=0.156GB, init=7.238GB, as_config=((8, 1), {})
cost[4, 6, 2]=0.181, max_n_succ_stage=327, Mem: avail=28.031GB, peak=4.140GB, intermediate=0.062GB, init=3.379GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 7, 0]=0.278, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=22.696GB, intermediate=0.047GB, init=8.359GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 7, 1]=0.140, max_n_succ_stage=604, Mem: avail=28.031GB, peak=5.425GB, intermediate=0.031GB, init=3.670GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 6, 2]=0.249, max_n_succ_stage=194, Mem: avail=28.031GB, peak=5.043GB, intermediate=0.094GB, init=4.693GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 6, 3]=0.310, max_n_succ_stage=127, Mem: avail=28.031GB, peak=6.110GB, intermediate=0.125GB, init=5.819GB, as_config=((8, 1), {})
cost[3, 6, 3]=0.249, max_n_succ_stage=194, Mem: avail=28.031GB, peak=5.043GB, intermediate=0.094GB, init=4.693GB, as_config=((8, 1), {})
cost[0, 6, 0]=0.283, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=22.125GB, intermediate=0.047GB, init=8.174GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 6, 1]=0.145, max_n_succ_stage=638, Mem: avail=28.031GB, peak=4.675GB, intermediate=0.031GB, init=3.377GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 7, 2]=0.232, max_n_succ_stage=194, Mem: avail=28.031GB, peak=4.885GB, intermediate=0.094GB, init=4.798GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 6, 1]=0.199, max_n_succ_stage=349, Mem: avail=28.031GB, peak=6.898GB, intermediate=0.047GB, init=4.690GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 7, 0]=0.238, max_n_succ_stage=28, Mem: avail=28.031GB, peak=19.632GB, intermediate=0.039GB, init=7.233GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 7, 3]=0.173, max_n_succ_stage=319, Mem: avail=28.031GB, peak=4.353GB, intermediate=0.062GB, init=3.672GB, as_config=((8, 1), {})
cost[5, 7, 2]=0.173, max_n_succ_stage=319, Mem: avail=28.031GB, peak=4.353GB, intermediate=0.062GB, init=3.672GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 7, 0]=0.154, max_n_succ_stage=433, Mem: avail=28.031GB, peak=13.052GB, intermediate=0.023GB, init=4.795GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 7, 1]=0.187, max_n_succ_stage=346, Mem: avail=28.031GB, peak=6.926GB, intermediate=0.047GB, init=4.796GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 7, 1]=0.290, max_n_succ_stage=134, Mem: avail=28.031GB, peak=10.178GB, intermediate=0.078GB, init=7.235GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 7, 2]=0.482, max_n_succ_stage=45, Mem: avail=28.031GB, peak=8.309GB, intermediate=0.219GB, init=9.599GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 7, 3]=0.232, max_n_succ_stage=194, Mem: avail=28.031GB, peak=4.885GB, intermediate=0.094GB, init=4.798GB, as_config=((8, 1), {})
cost[3, 7, 3]=0.300, max_n_succ_stage=128, Mem: avail=28.031GB, peak=5.674GB, intermediate=0.125GB, init=6.112GB, as_config=((8, 1), {})
cost[3, 7, 2]=0.300, max_n_succ_stage=128, Mem: avail=28.031GB, peak=5.674GB, intermediate=0.125GB, init=6.112GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 6, 1]=0.346, max_n_succ_stage=84, Mem: avail=28.031GB, peak=11.831GB, intermediate=0.094GB, init=8.176GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 7, 0]=0.199, max_n_succ_stage=170, Mem: avail=28.031GB, peak=16.569GB, intermediate=0.031GB, init=6.108GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 7, 1]=0.242, max_n_succ_stage=210, Mem: avail=28.031GB, peak=8.677GB, intermediate=0.062GB, init=6.109GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 7, 2]=0.361, max_n_succ_stage=90, Mem: avail=28.031GB, peak=6.558GB, intermediate=0.156GB, init=7.238GB, as_config=((1, 8), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 7, 3]=0.482, max_n_succ_stage=45, Mem: avail=28.031GB, peak=8.309GB, intermediate=0.219GB, init=9.599GB, as_config=((8, 1), {})
cost[0, 7, 0]=0.318, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=26.033GB, intermediate=0.055GB, init=9.592GB, as_config=((4, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 7, 1]=0.388, max_n_succ_stage=46, Mem: avail=28.031GB, peak=13.293GB, intermediate=0.109GB, init=9.595GB, as_config=((2, 4), {'force_batch_dim_to_mesh_dim': 0})
Profiling for submesh 3 (1, 8) takes 338.04 seconds
Profiled costs are: [[[       inf        inf        inf        inf]
  [0.07987126 0.09739454 0.12200893 0.12991459]
  [0.1196132  0.14619282 0.18302987 0.19093553]
  [0.1643917  0.20077806 0.25026275 0.25026275]
  [0.20329163 0.24835482 0.30955188 0.30955188]
  [0.24303357 0.29715306 0.37057281 0.37057281]
  [0.2827755  0.34595129 0.43159375 0.43159375]
  [0.31831989 0.38812688 0.48233213 0.48233213]]

 [[       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [0.12419358 0.15170304 0.18956885 0.18956885]
  [0.16309351 0.1992798  0.24885798 0.24885798]
  [0.20283545 0.24807803 0.30987892 0.30987892]
  [0.24257739 0.29687627 0.37089986 0.37089986]
  [0.27815655 0.33929161 0.42178694 0.42178694]]

 [[       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [0.08445164 0.10290477 0.12854791 0.12854791]
  [0.12335158 0.15048157 0.18783704 0.18783704]
  [0.16309351 0.1992798  0.24885798 0.24885798]
  [0.20283545 0.24807803 0.30987892 0.30987892]
  [0.23841461 0.29049338 0.360766   0.360766  ]]

 [[       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [0.08360964 0.1016833  0.1268161  0.1268161 ]
  [0.12335158 0.15048157 0.18783704 0.18783704]
  [0.16309351 0.1992798  0.24885798 0.24885798]
  [0.19867267 0.24169515 0.29974506 0.29974506]]

 [[       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [0.11834979 0.14493431 0.1811823  0.1811823 ]
  [0.15389418 0.1871099  0.23192068 0.23192068]]

 [[       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [0.11499424 0.13953314 0.17263155 0.17263155]]

 [[       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]]

 [[       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]]]
Profiled max_n_succ_stages are: [[[  -1   -1   -1   -1]
  [2460 1434  717  716]
  [ 964  620  325  325]
  [ 435  346  192  192]
  [ 193  215  125  125]
  [  46  136   90   90]
  [  -1   84   63   63]
  [  -1   46   45   45]]

 [[  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [ 943  614  325  325]
  [ 450  350  192  192]
  [ 204  218  129  129]
  [  56  139   90   90]
  [  -1   84   64   64]]

 [[  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [2418 1403  706  706]
  [ 944  613  322  322]
  [ 451  349  191  191]
  [ 204  218  127  127]
  [  28  134   90   90]]

 [[  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [2420 1418  708  708]
  [ 944  612  322  322]
  [ 451  349  194  194]
  [ 170  210  128  128]]

 [[  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [ 989  638  327  327]
  [ 433  346  194  194]]

 [[  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [ 918  604  319  319]]

 [[  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]]

 [[  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]]]
--------------------------------------------------
- Profiling for submesh 2 (1, 4):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
cost[4, 5, 3]=0.173, max_n_succ_stage=593, Mem: avail=28.031GB, peak=4.956GB, intermediate=0.031GB, init=4.503GB, as_config=((4, 1), {})
cost[4, 5, 2]=0.173, max_n_succ_stage=593, Mem: avail=28.031GB, peak=4.956GB, intermediate=0.031GB, init=4.503GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 4, 0]=0.140, max_n_succ_stage=1271, Mem: avail=28.031GB, peak=13.214GB, intermediate=0.008GB, init=4.876GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 0, 1]=0.074, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=3.432GB, intermediate=0.000GB, init=2.468GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 4, 3]=0.184, max_n_succ_stage=579, Mem: avail=28.031GB, peak=5.018GB, intermediate=0.031GB, init=4.878GB, as_config=((4, 1), {})
cost[3, 4, 1]=0.155, max_n_succ_stage=1048, Mem: avail=28.031GB, peak=6.752GB, intermediate=0.016GB, init=4.877GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 0, 0]=0.067, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=6.595GB, intermediate=0.000GB, init=2.467GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 3, 0]=0.075, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=7.158GB, intermediate=0.000GB, init=2.626GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 0, 3]=0.087, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=2.826GB, intermediate=0.000GB, init=2.468GB, as_config=((4, 1), {})
cost[3, 3, 3]=0.098, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=3.009GB, intermediate=0.000GB, init=2.627GB, as_config=((4, 1), {})
cost[3, 3, 2]=0.098, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=3.009GB, intermediate=0.000GB, init=2.627GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 0, 2]=0.087, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=2.826GB, intermediate=0.000GB, init=2.468GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 3, 1]=0.083, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=3.642GB, intermediate=0.000GB, init=2.626GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 1, 2]=0.175, max_n_succ_stage=583, Mem: avail=28.031GB, peak=5.038GB, intermediate=0.031GB, init=4.720GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 1, 1]=0.148, max_n_succ_stage=1077, Mem: avail=28.031GB, peak=6.463GB, intermediate=0.016GB, init=4.718GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 3, 3]=0.186, max_n_succ_stage=575, Mem: avail=28.031GB, peak=5.143GB, intermediate=0.031GB, init=4.878GB, as_config=((4, 1), {})
cost[3, 5, 2]=0.271, max_n_succ_stage=226, Mem: avail=28.031GB, peak=6.706GB, intermediate=0.062GB, init=7.129GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 1, 0]=0.133, max_n_succ_stage=1338, Mem: avail=28.031GB, peak=12.847GB, intermediate=0.008GB, init=4.718GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 3, 2]=0.186, max_n_succ_stage=575, Mem: avail=28.031GB, peak=5.143GB, intermediate=0.031GB, init=4.878GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 4, 2]=0.184, max_n_succ_stage=579, Mem: avail=28.031GB, peak=5.018GB, intermediate=0.031GB, init=4.878GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 2, 2]=0.175, max_n_succ_stage=594, Mem: avail=28.031GB, peak=4.924GB, intermediate=0.031GB, init=4.503GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 3, 1]=0.157, max_n_succ_stage=1048, Mem: avail=28.031GB, peak=6.752GB, intermediate=0.016GB, init=4.877GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 2, 1]=0.147, max_n_succ_stage=1104, Mem: avail=28.031GB, peak=6.252GB, intermediate=0.016GB, init=4.502GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 2, 0]=0.132, max_n_succ_stage=1438, Mem: avail=28.031GB, peak=12.284GB, intermediate=0.008GB, init=4.501GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 1, 3]=0.175, max_n_succ_stage=584, Mem: avail=28.031GB, peak=5.030GB, intermediate=0.031GB, init=4.720GB, as_config=((4, 1), {})
cost[4, 5, 0]=0.131, max_n_succ_stage=1438, Mem: avail=28.031GB, peak=12.285GB, intermediate=0.008GB, init=4.501GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 3, 0]=0.141, max_n_succ_stage=1267, Mem: avail=28.031GB, peak=13.246GB, intermediate=0.008GB, init=4.876GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 5, 1]=0.145, max_n_succ_stage=1107, Mem: avail=28.031GB, peak=6.206GB, intermediate=0.016GB, init=4.502GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 2, 3]=0.175, max_n_succ_stage=594, Mem: avail=28.031GB, peak=4.924GB, intermediate=0.031GB, init=4.503GB, as_config=((4, 1), {})
cost[5, 6, 0]=0.132, max_n_succ_stage=1438, Mem: avail=28.031GB, peak=12.285GB, intermediate=0.008GB, init=4.501GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 6, 1]=0.147, max_n_succ_stage=1107, Mem: avail=28.031GB, peak=6.206GB, intermediate=0.016GB, init=4.502GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 6, 2]=0.175, max_n_succ_stage=591, Mem: avail=28.031GB, peak=5.026GB, intermediate=0.031GB, init=4.503GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 6, 3]=0.175, max_n_succ_stage=591, Mem: avail=28.031GB, peak=5.026GB, intermediate=0.031GB, init=4.503GB, as_config=((4, 1), {})
cost[0, 2, 2]=0.263, max_n_succ_stage=230, Mem: avail=28.031GB, peak=6.601GB, intermediate=0.062GB, init=6.971GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 6, 2]=0.260, max_n_succ_stage=239, Mem: avail=28.031GB, peak=6.262GB, intermediate=0.062GB, init=6.754GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 5, 3]=0.271, max_n_succ_stage=226, Mem: avail=28.031GB, peak=6.706GB, intermediate=0.062GB, init=7.129GB, as_config=((4, 1), {})
cost[2, 4, 2]=0.271, max_n_succ_stage=224, Mem: avail=28.031GB, peak=6.793GB, intermediate=0.062GB, init=7.129GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 6, 0]=0.197, max_n_succ_stage=188, Mem: avail=28.031GB, peak=18.317GB, intermediate=0.016GB, init=6.752GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 3, 3]=0.273, max_n_succ_stage=225, Mem: avail=28.031GB, peak=6.738GB, intermediate=0.062GB, init=7.129GB, as_config=((4, 1), {})
cost[0, 2, 3]=0.263, max_n_succ_stage=230, Mem: avail=28.031GB, peak=6.593GB, intermediate=0.062GB, init=6.971GB, as_config=((4, 1), {})
cost[6, 7, 2]=0.164, max_n_succ_stage=566, Mem: avail=28.031GB, peak=5.222GB, intermediate=0.031GB, init=5.089GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[6, 7, 0]=0.127, max_n_succ_stage=1165, Mem: avail=28.031GB, peak=13.832GB, intermediate=0.008GB, init=5.087GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 6, 1]=0.219, max_n_succ_stage=384, Mem: avail=28.031GB, peak=9.238GB, intermediate=0.031GB, init=6.753GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 2, 0]=0.199, max_n_succ_stage=138, Mem: avail=28.031GB, peak=18.880GB, intermediate=0.016GB, init=6.969GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[6, 7, 1]=0.140, max_n_succ_stage=1023, Mem: avail=28.031GB, peak=6.940GB, intermediate=0.016GB, init=5.088GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 3, 2]=0.273, max_n_succ_stage=225, Mem: avail=28.031GB, peak=6.738GB, intermediate=0.062GB, init=7.129GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 4, 3]=0.271, max_n_succ_stage=224, Mem: avail=28.031GB, peak=6.793GB, intermediate=0.062GB, init=7.129GB, as_config=((4, 1), {})
cost[2, 4, 0]=0.206, max_n_succ_stage=100, Mem: avail=28.031GB, peak=19.317GB, intermediate=0.016GB, init=7.127GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 5, 0]=0.206, max_n_succ_stage=100, Mem: avail=28.031GB, peak=19.317GB, intermediate=0.016GB, init=7.127GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[6, 7, 3]=0.164, max_n_succ_stage=566, Mem: avail=28.031GB, peak=5.222GB, intermediate=0.031GB, init=5.089GB, as_config=((4, 1), {})
cost[5, 7, 2]=0.251, max_n_succ_stage=225, Mem: avail=28.031GB, peak=6.547GB, intermediate=0.062GB, init=7.340GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 3, 0]=0.207, max_n_succ_stage=96, Mem: avail=28.031GB, peak=19.380GB, intermediate=0.016GB, init=7.127GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 2, 1]=0.221, max_n_succ_stage=369, Mem: avail=28.031GB, peak=9.496GB, intermediate=0.031GB, init=6.969GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 7, 3]=0.251, max_n_succ_stage=225, Mem: avail=28.031GB, peak=6.547GB, intermediate=0.062GB, init=7.340GB, as_config=((4, 1), {})
cost[4, 6, 3]=0.260, max_n_succ_stage=239, Mem: avail=28.031GB, peak=6.262GB, intermediate=0.062GB, init=6.754GB, as_config=((4, 1), {})
cost[5, 7, 0]=0.193, max_n_succ_stage=52, Mem: avail=28.031GB, peak=19.865GB, intermediate=0.016GB, init=7.338GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 5, 1]=0.228, max_n_succ_stage=355, Mem: avail=28.031GB, peak=9.769GB, intermediate=0.031GB, init=7.128GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 7, 1]=0.213, max_n_succ_stage=325, Mem: avail=28.031GB, peak=10.504GB, intermediate=0.031GB, init=7.339GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 3, 1]=0.230, max_n_succ_stage=355, Mem: avail=28.031GB, peak=9.769GB, intermediate=0.031GB, init=7.128GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 4, 1]=0.228, max_n_succ_stage=355, Mem: avail=28.031GB, peak=9.769GB, intermediate=0.031GB, init=7.128GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 7, 3]=0.337, max_n_succ_stage=112, Mem: avail=28.031GB, peak=7.837GB, intermediate=0.094GB, init=9.592GB, as_config=((4, 1), {})
cost[4, 7, 0]=0.257, max_n_succ_stage=-1, Mem: avail=28.031GB, peak=25.991GB, intermediate=0.023GB, init=9.588GB, as_config=((4, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 7, 2]=0.337, max_n_succ_stage=112, Mem: avail=28.031GB, peak=7.837GB, intermediate=0.094GB, init=9.592GB, as_config=((1, 4), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 7, 1]=0.285, max_n_succ_stage=102, Mem: avail=28.031GB, peak=13.567GB, intermediate=0.047GB, init=9.590GB, as_config=((2, 2), {'force_batch_dim_to_mesh_dim': 0})
Profiling for submesh 2 (1, 4) takes 176.16 seconds
Profiled costs are: [[[0.06709255 0.07428593 0.08741373 0.08739106]
  [0.13303221 0.14777842 0.1750141  0.17499143]
  [0.19897187 0.22127113 0.26261446 0.26259179]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]]

 [[       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [0.13187982 0.14692348 0.17466843 0.17464576]
  [0.20681083 0.23002846 0.27335096 0.27335096]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]]

 [[       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [0.14087117 0.15653575 0.18575059 0.18575059]
  [0.20552999 0.22842866 0.27116122 0.27116122]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]]

 [[       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [0.07493151 0.08304319 0.09815022 0.09815022]
  [0.13959033 0.15493595 0.18356085 0.18356085]
  [0.20552999 0.22842866 0.27116122 0.27116122]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]]

 [[       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [0.13059899 0.14535502 0.17289409 0.17289409]
  [0.19653865 0.21884772 0.26049446 0.26049446]
  [0.25723433 0.28490171 0.33659338 0.33659338]]

 [[       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [0.13187982 0.14695481 0.17508383 0.17508383]
  [0.1925755  0.2130088  0.25118275 0.25118275]]

 [[       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [0.12663584 0.13950776 0.16358238 0.16358238]]

 [[       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]]]
Profiled max_n_succ_stages are: [[[4096 4096 4096 4096]
  [1338 1077  583  584]
  [ 138  369  230  230]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]]

 [[  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [1438 1104  594  594]
  [  96  355  225  225]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]]

 [[  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [1267 1048  575  575]
  [ 100  355  224  224]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]]

 [[  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [4096 4096 4096 4096]
  [1271 1048  579  579]
  [ 100  355  226  226]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]]

 [[  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [1438 1107  593  593]
  [ 188  384  239  239]
  [  -1  102  112  112]]

 [[  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [1438 1107  591  591]
  [  52  325  225  225]]

 [[  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [1165 1023  566  566]]

 [[  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]]]
--------------------------------------------------
- Profiling for submesh 1 (1, 2):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
cost[7, 7, 2]=0.125, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=5.284GB, intermediate=0.000GB, init=5.674GB, as_config=((2, 1), {})
cost[7, 7, 0]=0.115, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=8.033GB, intermediate=0.000GB, init=5.673GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[7, 7, 1]=0.125, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=5.284GB, intermediate=0.000GB, init=5.674GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[6, 6, 2]=0.138, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=4.518GB, intermediate=0.000GB, init=4.502GB, as_config=((2, 1), {})
cost[6, 6, 0]=0.123, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=6.127GB, intermediate=0.000GB, init=4.501GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 0, 2]=0.141, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=4.666GB, intermediate=0.000GB, init=4.935GB, as_config=((2, 1), {})
cost[6, 6, 1]=0.138, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=4.518GB, intermediate=0.000GB, init=4.502GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 5, 1]=0.138, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=4.565GB, intermediate=0.000GB, init=4.502GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[6, 7, 0]=0.238, max_n_succ_stage=205, Mem: avail=28.031GB, peak=14.629GB, intermediate=0.016GB, init=10.175GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 0, 0]=0.127, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=6.611GB, intermediate=0.000GB, init=4.935GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 2, 2]=0.138, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=4.455GB, intermediate=0.000GB, init=4.502GB, as_config=((2, 1), {})
cost[1, 1, 1]=0.138, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=4.455GB, intermediate=0.000GB, init=4.502GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 5, 0]=0.123, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=6.080GB, intermediate=0.000GB, init=4.501GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[0, 0, 1]=0.141, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=4.666GB, intermediate=0.000GB, init=4.935GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 2, 1]=0.138, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=4.455GB, intermediate=0.000GB, init=4.502GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 3, 1]=0.156, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=4.893GB, intermediate=0.000GB, init=5.252GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 4, 0]=0.121, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=6.080GB, intermediate=0.000GB, init=4.501GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[3, 3, 2]=0.156, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=4.893GB, intermediate=0.000GB, init=5.252GB, as_config=((2, 1), {})
cost[4, 4, 1]=0.135, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=4.456GB, intermediate=0.000GB, init=4.502GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 1, 0]=0.123, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=6.142GB, intermediate=0.000GB, init=4.501GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 1, 2]=0.138, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=4.455GB, intermediate=0.000GB, init=4.502GB, as_config=((2, 1), {})
cost[4, 4, 2]=0.135, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=4.456GB, intermediate=0.000GB, init=4.502GB, as_config=((2, 1), {})
cost[2, 2, 0]=0.123, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=6.142GB, intermediate=0.000GB, init=4.501GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[5, 5, 2]=0.138, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=4.565GB, intermediate=0.000GB, init=4.502GB, as_config=((2, 1), {})
cost[3, 3, 0]=0.140, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=7.142GB, intermediate=0.000GB, init=5.251GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[6, 7, 1]=0.263, max_n_succ_stage=302, Mem: avail=28.031GB, peak=8.379GB, intermediate=0.031GB, init=10.176GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[6, 7, 2]=0.263, max_n_succ_stage=302, Mem: avail=28.031GB, peak=8.379GB, intermediate=0.031GB, init=10.176GB, as_config=((2, 1), {})
cost[1, 2, 2]=0.276, max_n_succ_stage=360, Mem: avail=28.031GB, peak=7.738GB, intermediate=0.031GB, init=9.003GB, as_config=((2, 1), {})
cost[5, 6, 1]=0.276, max_n_succ_stage=355, Mem: avail=28.031GB, peak=7.894GB, intermediate=0.031GB, init=9.004GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 2, 1]=0.276, max_n_succ_stage=360, Mem: avail=28.031GB, peak=7.738GB, intermediate=0.031GB, init=9.003GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 5, 1]=0.273, max_n_succ_stage=358, Mem: avail=28.031GB, peak=7.785GB, intermediate=0.031GB, init=9.004GB, as_config=((1, 2), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 5, 2]=0.273, max_n_succ_stage=358, Mem: avail=28.031GB, peak=7.785GB, intermediate=0.031GB, init=9.004GB, as_config=((2, 1), {})
cost[5, 6, 2]=0.276, max_n_succ_stage=355, Mem: avail=28.031GB, peak=7.894GB, intermediate=0.031GB, init=9.004GB, as_config=((2, 1), {})
cost[5, 6, 0]=0.247, max_n_succ_stage=380, Mem: avail=28.031GB, peak=13.066GB, intermediate=0.016GB, init=9.002GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 2, 0]=0.247, max_n_succ_stage=380, Mem: avail=28.031GB, peak=13.066GB, intermediate=0.016GB, init=9.002GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 5, 0]=0.245, max_n_succ_stage=380, Mem: avail=28.031GB, peak=13.066GB, intermediate=0.016GB, init=9.002GB, as_config=((2, 1), {'force_batch_dim_to_mesh_dim': 0})
Profiling for submesh 1 (1, 2) takes 67.62 seconds
Profiled costs are: [[[0.12691331 0.14066477 0.14063352        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]]

 [[       inf        inf        inf        inf]
  [0.12344989 0.13773823 0.13773823        inf]
  [0.24689925 0.27568186 0.27565061        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]]

 [[       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [0.12344989 0.13773823 0.13773823        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]]

 [[       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [0.14014374 0.15570581 0.15570581        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]]

 [[       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [0.12106749 0.13487451 0.13487451        inf]
  [0.24451685 0.27278689 0.27278689        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]]

 [[       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [0.12344989 0.1378638  0.1378638         inf]
  [0.24689925 0.27577618 0.27577618        inf]
  [       inf        inf        inf        inf]]

 [[       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [0.12344989 0.13781522 0.13781522        inf]
  [0.2383031  0.26298267 0.26298267        inf]]

 [[       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [0.11485375 0.12507029 0.12507029        inf]]]
Profiled max_n_succ_stages are: [[[4096 4096 4096   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]]

 [[  -1   -1   -1   -1]
  [4096 4096 4096   -1]
  [ 380  360  360   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]]

 [[  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [4096 4096 4096   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]]

 [[  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [4096 4096 4096   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]]

 [[  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [4096 4096 4096   -1]
  [ 380  358  358   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]]

 [[  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [4096 4096 4096   -1]
  [ 380  355  355   -1]
  [  -1   -1   -1   -1]]

 [[  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [4096 4096 4096   -1]
  [ 205  302  302   -1]]

 [[  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [4096 4096 4096   -1]]]
--------------------------------------------------
- Profiling for submesh 0 (1, 1):
- Generate all stage infos (Jaxpr -> HLO)
- Compile all stages
- Profile all stages
cost[7, 7, 0]=0.226, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=9.348GB, intermediate=0.000GB, init=11.347GB, as_config=((1, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[7, 7, 1]=0.226, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=9.348GB, intermediate=0.000GB, init=11.347GB, as_config=((1, 1), {})
cost[6, 6, 1]=0.242, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=7.754GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {})
cost[6, 6, 0]=0.242, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=7.754GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[4, 4, 1]=0.237, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=7.817GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {})
cost[4, 4, 0]=0.237, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=7.817GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[2, 2, 0]=0.242, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=7.598GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 1, 0]=0.242, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=7.598GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {'force_batch_dim_to_mesh_dim': 0})
cost[1, 1, 1]=0.242, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=7.598GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {})
cost[2, 2, 1]=0.242, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=7.598GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {})
cost[5, 5, 1]=0.242, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=7.723GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {})
cost[5, 5, 0]=0.242, max_n_succ_stage=4096, Mem: avail=28.031GB, peak=7.723GB, intermediate=0.000GB, init=9.002GB, as_config=((1, 1), {'force_batch_dim_to_mesh_dim': 0})
Profiling for submesh 0 (1, 1) takes 24.18 seconds
Profiled costs are: [[[       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]]

 [[       inf        inf        inf        inf]
  [0.24218938 0.24218938        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]]

 [[       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [0.24218938 0.24218938        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]]

 [[       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]]

 [[       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [0.23742512 0.23742512        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]]

 [[       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [0.24218938 0.24218938        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]]

 [[       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [0.24218938 0.24218938        inf        inf]
  [       inf        inf        inf        inf]]

 [[       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [       inf        inf        inf        inf]
  [0.22611361 0.22611361        inf        inf]]]
Profiled max_n_succ_stages are: [[[  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]]

 [[  -1   -1   -1   -1]
  [4096 4096   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]]

 [[  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [4096 4096   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]]

 [[  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]]

 [[  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [4096 4096   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]]

 [[  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [4096 4096   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]]

 [[  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [4096 4096   -1   -1]
  [  -1   -1   -1   -1]]

 [[  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [  -1   -1   -1   -1]
  [4096 4096   -1   -1]]]
--------------------------------------------------
Compute cost saved to: compute-cost-2022-11-12-03-59-49.npy
----------------------------------------------------------------------
Result forward_stage_layer_ids: [[0, 1], [2], [3, 4], [5, 6], [7]]
Result mesh_shapes: [(1, 4), (1, 2), (1, 4), (1, 4), (1, 2)]
Result logical_mesh_shapes: [(4, 1), (2, 1), (4, 1), (4, 1), (2, 1)]
Result autosharding_option_dicts: [{'force_batch_dim_to_mesh_dim': 0}, {'force_batch_dim_to_mesh_dim': 0}, {'force_batch_dim_to_mesh_dim': 0}, {'force_batch_dim_to_mesh_dim': 0}, {'force_batch_dim_to_mesh_dim': 0}]
 - Compile (driver): 796.78 s
compilation time breakdown: {'stage-construction': '709.34', 'stage-construction-dp': '1.58', 'stage-construction-compilation': '505.29', 'stage-construction-profiling': '198.66'}
 - Compile (worker): 31.21 s
Iteration 0 ...
Iteration 1 ...
Iteration 2 ...
 - Benchmark: 258.46 s
Type: gpt  Model Config: GPTModelConfig(seq_len=1024, hidden_size=4096, num_layers=32, num_heads=32, vocab_size=51200)  #Microbatch: 256  #GPU: 16  Parallel Config: SearchParallelArgs(prefer_reduce_scatter=True, use_remat=True, num_auto_layers=8, auto_stage_option={'submesh_physical_shape_space': 'small_power_of_two', 'submesh_logical_shape_space': 'all', 'stage_imbalance_tolerance': 1.0, 'use_hlo_cost_model': True, 'profiling_database_filename': 'prof_database.pkl'})  Mean Time (s): 77.133  Std Time (s): 0.071  #Params (Billion): 6.654B  TFLOPs: 46.68  Peak Mem (GB): 14.700  Metadata: {'compilation_times': "{'stage-construction': '709.34', 'stage-construction-dp': '1.58', 'stage-construction-compilation': '505.29', 'stage-construction-profiling': '198.66'}", 'compute_cost_file_name': 'compute-cost-2022-11-12-03-59-49.npy', 'forward_stage_layer_ids': '[[0, 1], [2], [3, 4], [5, 6], [7]]', 'submesh_shapes': '[[1, 4], [1, 2], [1, 4], [1, 4], [1, 2]]', 'logical_mesh_shapes': '[[4, 1], [2, 1], [4, 1], [4, 1], [2, 1]]', 'autosharding_option_dicts': "[{'force_batch_dim_to_mesh_dim': '0'}, {'force_batch_dim_to_mesh_dim': '0'}, {'force_batch_dim_to_mesh_dim': '0'}, {'force_batch_dim_to_mesh_dim': '0'}, {'force_batch_dim_to_mesh_dim': '0'}]"}  
