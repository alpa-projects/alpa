##  Single node, 8x A100


| Model    | num\_layers | hidden\_size | num\_heads | \# gpus | data parallel | model parallel | ZeRO Stage | CPU Offload | Max Global BSZ               | time/it (ms) | Throughput (samples/sec) | GPU0 Memory Usage   | GPU1 Memory Usage   | GPU2 Memory Usage   | GPU3 Memory Usage   | GPU4 Memory Usage   | GPU5 Memory Usage   | GPU6 Memory Usage   | GPU7 Memory Usage   | Notes                                                                 |
| -------- | ----------- | ------------ | ---------- | ------- | ------------- | -------------- | ---------- | ----------- | ---------------------------- | ------------ | ------------------------ | ------------------- | ------------------- | ------------------- | ------------------- | ------------------- | ------------------- | ------------------- | ------------------- | --------------------------------------------------------------------- |
| GPT-345M | 24          | 1024         | 16         | 8       | 8             | 1              | 0          | No          | 256                          | 1658.238935  | 154.3806472              | 30760MiB / 40537MiB | 31192MiB / 40537MiB | 31192MiB / 40537MiB | 31192MiB / 40537MiB | 31192MiB / 40537MiB | 31192MiB / 40537MiB | 31192MiB / 40537MiB | 30760MiB / 40537MiB |                                                                       |
| GPT-345M | 24          | 1024         | 16         | 8       | 1             | 8              | 0          | No          | 128                          | 1541.9       | 83.01446268              | 28664MiB / 40537MiB | 28952MiB / 40537MiB | 28952MiB / 40537MiB | 28952MiB / 40537MiB | 29208MiB / 40537MiB | 28696MiB / 40537MiB | 28952MiB / 40537MiB | 28152MiB / 40537MiB |                                                                       |
| GPT-345M | 24          | 1024         | 16         | 8       | 8             | 1              | 1          | No          | 512                          | 3330.348869  | 153.7376474              | 35786MiB / 40537MiB | 36074MiB / 40537MiB | 36074MiB / 40537MiB | 36074MiB / 40537MiB | 36074MiB / 40537MiB | 36074MiB / 40537MiB | 36074MiB / 40537MiB | 35786MiB / 40537MiB |                                                                       |
| GPT-345M | 24          | 1024         | 16         | 8       | 1             | 8              | 1          | No          | 128                          | 1529.87937   | 83.66672726              | 28898MiB / 40537MiB | 28930MiB / 40537MiB | 29442MiB / 40537MiB | 29186MiB / 40537MiB | 29186MiB / 40537MiB | 29186MiB / 40537MiB | 28930MiB / 40537MiB | 29154MiB / 40537MiB |                                                                       |
| GPT-345M | 24          | 1024         | 16         | 8       | 8             | 1              | 2          | No          | 512                          | 3274.954827  | 156.3380343              | 35666MiB / 40537MiB | 35954MiB / 40537MiB | 35954MiB / 40537MiB | 35954MiB / 40537MiB | 35954MiB / 40537MiB | 35954MiB / 40537MiB | 35954MiB / 40537MiB | 35666MiB / 40537MiB |                                                                       |
| GPT-345M | 24          | 1024         | 16         | 8       | 8             | 1              | 2          | Yes         | 512                          | 3915.7       | 130.7556759              | 35360MiB / 40537MiB | 35614MiB / 40537MiB | 35384MiB / 40537MiB | 35364MiB / 40537MiB | 35384MiB / 40537MiB | 35368MiB / 40537MiB | 35394MiB / 40537MiB | 35052MiB / 40537MiB |                                                                       |
| GPT-345M | 24          | 1024         | 16         | 8       | 1             | 8              | 2          | No          | 128                          | 1520.643019  | 84.17491706              | 28468MiB / 40537MiB | 29012MiB / 40537MiB | 28756MiB / 40537MiB | 28756MiB / 40537MiB | 29012MiB / 40537MiB | 28500MiB / 40537MiB | 28500MiB / 40537MiB | 28212MiB / 40537MiB |                                                                       |
| GPT-345M | 24          | 1024         | 16         | 8       | 8             | 1              | 3          | No          | 512                          | 3031.7       | 168.8821453              | 34692Mib / 40537MiB | 34980Mib / 40537MiB | 34980Mib / 40537MiB | 34980Mib / 40537MiB | 34980Mib / 40537MiB | 34980Mib / 40537MiB | 34980Mib / 40537MiB | 34672Mib / 40537MiB |                                                                       |
| GPT-345M | 24          | 1024         | 16         | 8       | 8             | 1              | 3          | Yes         | 512                          | 3497         | 146.4112096              | 34226MiB / 40537MiB | 34494MiB / 40537MiB | 34494MiB / 40537MiB | 34514MiB / 40537MiB | 34514MiB / 40537MiB | 34514MiB / 40537MiB | 34514MiB / 40537MiB | 34226MiB / 40537MiB |                                                                       |
| GPT-345M | 24          | 1024         | 16         | 8       | 1             | 8              | 3          | No          | 256                          | 2857.654341  | 89.58396274              | 38930MiB / 40537MiB | 39218MiB / 40537MiB | 39218MiB / 40537MiB | 39218MiB / 40537MiB | 39218MiB / 40537MiB | 39218MiB / 40537MiB | 39218MiB / 40537MiB | 38930MiB / 40537MiB |                                                                       |
|          |             |              |            |         |               |                |            |             |                              |              |                          |                     |                     |                     |                     |                     |                     |                     |                     |                                                                       |
|          |             |              |            |         |               |                |            |             |                              |              |                          |                     |                     |                     |                     |                     |                     |                     |                     |                                                                       |
|          |             |              |            |         |               |                |            |             |                              |              |                          |                     |                     |                     |                     |                     |                     |                     |                     |                                                                       |
| GPT-2.5B | 48          | 2048         | 16         | 8       | 1             | 1              | 0          | No          | Cannot even initialize model |              | #VALUE!                  |                     |                     |                     |                     |                     |                     |                     |                     |                                                                       |
| GPT-2.5B | 48          | 2048         | 16         | 8       | 8             | 1              | 0          | No          | Cannot even initialize model |              |                          |                     |                     |                     |                     |                     |                     |                     |                     |                                                                       |
| GPT-2.5B | 48          | 2048         | 16         | 8       | 1             | 8              | 0          | No          | 32                           | 1490.771178  | 21.46540023              | 28312MiB / 40537MiB | 28620MiB / 40537MiB | 28728MiB / 40537MiB | 28836MiB / 40537MiB | 28620MiB / 40537MiB | 28600MiB / 40537MiB | 28856MiB / 40537MiB | 28332MiB / 40537MiB | if batch size = 64, it gives CUDA Out of Memory on the 23rd iteration |
| GPT-2.5B | 48          | 2048         | 16         | 8       | 8             | 1              | 1          | No          | 256                          | 5598         | 45.73061808              | 35052MiB / 40537MiB | 35340MiB / 40537MiB | 35340MiB / 40537MiB | 35340MiB / 40537MiB | 35340MiB / 40537MiB | 35340MiB / 40537MiB | 35340MiB / 40537MiB | 35052MiB / 40537MiB |                                                                       |
| GPT-2.5B | 48          | 2048         | 16         | 8       | 1             | 8              | 1          | No          | 32                           | 1473.506966  | 21.71689767              | 27690MiB / 40537MiB | 27978MiB / 40537MiB | 27978MiB / 40537MiB | 27978MiB / 40537MiB | 27978MiB / 40537MiB | 27978MiB / 40537MiB | 27978MiB / 40537MiB | 27690MiB / 40537MiB |                                                                       |
| GPT-2.5B | 48          | 2048         | 16         | 8       | 8             | 1              | 2          | No          | 256                          | 6046.7       | 42.33714257              | 36444MiB / 40537MiB | 36732MiB / 40537MiB | 36732MiB / 40537MiB | 36732MiB / 40537MiB | 36732MiB / 40537MiB | 36732MiB / 40537MiB | 36732MiB / 40537MiB | 36444MiB / 40537MiB |                                                                       |
| GPT-2.5B | 48          | 2048         | 16         | 8       | 8             | 1              | 2          | Yes         | 256                          | 7277.5       | 35.17691515              | 33864MiB / 40537MiB | 33498MiB / 40537MiB | 33374MiB / 40537MiB | 33410MiB / 40537MiB | 33382MiB / 40537MiB | 33514MiB / 40537MiB | 33390MiB / 40537MiB | 33010MiB / 40537MiB |                                                                       |
| GPT-2.5B | 48          | 2048         | 16         | 8       | 1             | 8              | 2          | No          | 32                           | 1473.919261  | 21.71082287              | 27124MiB / 40537MiB | 27748MiB / 40537MiB | 27476MiB / 40537MiB | 27412MiB / 40537MiB | 27284MiB / 40537MiB | 27476MiB / 40537MiB | 27412MiB / 40537MiB | 27188MiB / 40537MiB |                                                                       |
| GPT-2.5B | 48          | 2048         | 16         | 8       | 1             | 8              | 2          | Yes         | 32                           | 2458.136997  | 13.01798884              | 25032MiB / 40537MiB | 25266MiB / 40537MiB | 25380MiB / 40537MiB | 25320MiB / 40537MiB | 25320MiB / 40537MiB | 25320MiB / 40537MiB | 25478MiB / 40537MiB | 25062MiB / 40537MiB |                                                                       |
| GPT-2.5B | 48          | 2048         | 16         | 8       | 8             | 1              | 3          | No          | 256                          | 5714.8       | 44.79596836              | 33638MiB / 40537MiB | 33926MiB / 40537MiB | 33926MiB / 40537MiB | 33946MiB / 40537MiB | 33946MiB / 40537MiB | 33946MiB / 40537MiB | 33926MiB / 40537MiB | 33658MiB / 40537MiB |                                                                       |
| GPT-2.5B | 48          | 2048         | 16         | 8       | 8             | 1              | 3          | Yes         | 512                          | 11438.7      | 44.76033116              | 37040MiB / 40537MiB | 37328MiB / 40537MiB | 37328MiB / 40537MiB | 37328MiB / 40537MiB | 37348MiB / 40537MiB | 37328MiB / 40537MiB | 37348MiB / 40537MiB | 37040MiB / 40537MiB |                                                                       |
| GPT-2.5B | 48          | 2048         | 16         | 8       | 1             | 8              | 3          | No          | 64                           | 1911.53      | 33.48103352              | 27012MiB / 40537MiB | 27300MiB / 40537MiB | 27300MiB / 40537MiB | 27300MiB / 40537MiB | 27300MiB / 40537MiB | 27300MiB / 40537MiB | 27300MiB / 40537MiB | 27012MiB / 40537MiB |                                                                       |
| GPT-2.5B | 48          | 2048         | 16         | 8       | 1             | 8              | 3          | Yes         | 128                          | 6524.8       | 19.61745954              | 40240MiB / 40537MiB | 40528MiB / 40537MiB | 40528MiB / 40537MiB | 40528MiB / 40537MiB | 40528MiB / 40537MiB | 40528MiB / 40537MiB | 40528MiB / 40537MiB | 40240MiB / 40537MiB |                                                                       |
|          |             |              |            |         |               |                |            |             |                              |              |                          |                     |                     |                     |                     |                     |                     |                     |                     |                                                                       |
|          |             |              |            |         |               |                |            |             |                              |              |                          |                     |                     |                     |                     |                     |                     |                     |                     |                                                                       |
|          |             |              |            |         |               |                |            |             |                              |              |                          |                     |                     |                     |                     |                     |                     |                     |                     |                                                                       |
| GPT-5.8B | 72          | 2560         | 32         | 8       | 8             | 1              | 0          | No          | Cannot even initialize model |              | #VALUE!                  |                     |                     |                     |                     |                     |                     |                     |                     |                                                                       |
| GPT-5.8B | 72          | 2560         | 32         | 8       | 1             | 8              | 0          | No          | 16                           | 1691.711626  | 9.457876719              | 36738MiB / 40537MiB | 36978MiB / 40537MiB | 37170MiB / 40537MiB | 36724MiB / 40537MiB | 36948MiB / 40537MiB | 36720MiB / 40537MiB | 37134MiB / 40537MiB | 37034MiB / 40537Mi  | if batch size = 32, it gives CUDA Out of Memory on the 25th iteration |
| GPT-5.8B | 72          | 2560         | 32         | 8       | 8             | 1              | 1          | No          | 64                           | 4557.5       | 14.04278662              | 39668MiB / 40537MiB | 39490MiB / 40537MiB | 38680MiB / 40537MiB | 38680MiB / 40537MiB | 39160MiB / 40537MiB | 40504MiB / 40537MiB | 39160MiB / 40537MiB | 35068MiB / 40537MiB |                                                                       |
| GPT-5.8B | 72          | 2560         | 32         | 8       | 8             | 1              | 2          | No          | 128                          | 6799.7       | 18.8243599               | 36816MiB / 40537MiB | 37104MiB / 40537MiB | 37104MiB / 40537MiB | 37104MiB / 40537MiB | 37104MiB / 40537MiB | 37104MiB / 40537MiB | 37104MiB / 40537MiB | 36816MiB / 40537MiB |                                                                       |
| GPT-5.8B | 72          | 2560         | 32         | 8       | 8             | 1              | 2          | Yes         | 128                          | 10328.5      | 12.39289345              | 29602MiB / 40537MiB | 29056MiB / 40537MiB | 29592MiB / 40537MiB | 30542MiB / 40537MiB | 32000MiB / 40537MiB | 32514MiB / 40537MiB | 32154MiB / 40537MiB | 40444MiB / 40537MiB |                                                                       |
| GPT-5.8B | 72          | 2560         | 32         | 8       | 8             | 1              | 3          | No          | 128                          | 6960.5       | 18.38948351              | 40366MiB / 40537MiB | 30666MiB / 40537MiB | 30666MiB / 40537MiB | 30666MiB / 40537MiB | 30666MiB / 40537MiB | 30666MiB / 40537MiB | 30666MiB / 40537MiB | 40366MiB / 40537MiB |                                                                       |
| GPT-5.8B | 72          | 2560         | 32         | 8       | 8             | 1              | 3          | Yes         | 256                          | 15385.4      | 16.6391514               | 33480MiB / 40537MiB | 33768MiB / 40537MiB | 33768MiB / 40537MiB | 33768MiB / 40537MiB | 33768MiB / 40537MiB | 33768MiB / 40537MiB | 33768MiB / 40537MiB | 33480MiB / 40537MiB |


## 2 nodes, each with 8x A100
All experiments run very slow. Seems to be a PyTorch A100 issue.


## 2 nodes, each with 4x V100, AWS
